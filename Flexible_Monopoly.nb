(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    116801,       2972]
NotebookOptionsPosition[    103503,       2751]
NotebookOutlinePosition[    103929,       2768]
CellTagsIndexPosition[    103886,       2765]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Cooperative", " ", "markets"}], "*)"}]], "Input",
 CellChangeTimes->{{3.890409392130954*^9, 
  3.890409424941111*^9}},ExpressionUUID->"3b4f6fe1-c147-44e7-8623-\
bc7d363681a7"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8695300907768693`*^9, 3.8695301263800807`*^9}, 
   3.869579799071973*^9, 3.869609191225527*^9, {3.8696125510492096`*^9, 
   3.8696126302865844`*^9}, {3.869612818878462*^9, 3.8696128356355124`*^9}, 
   3.869613193390823*^9, {3.8697562365427094`*^9, 3.869756251610731*^9}, {
   3.8697628619916663`*^9, 3.869762963389886*^9}, {3.869763351787159*^9, 
   3.8697633594165597`*^9}, 3.873922615424223*^9, {3.881707177696516*^9, 
   3.8817071787988605`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"ab6dbfaf-8785-41ab-9cd1-36310adeb4d0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"2", "G"}], "*)"}]], "Input",ExpressionUUID->"a35c5a9d-f4ea-412f-8b2a-5caa04b0e815"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"B1", " ", "=", "B2"}], "\[IndentingNewLine]", 
 RowBox[{"c1", " ", "=", " ", "c2"}]}], "Input",
 CellChangeTimes->{{3.8904334190730047`*^9, 3.8904334359945917`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"096ddc44-6575-4d55-928a-db3ac3b2437a"],

Cell[BoxData["B2"], "Output",
 CellChangeTimes->{3.8904274413601146`*^9, 3.8904313533311377`*^9, 
  3.8904334604679117`*^9, 3.890437337465905*^9, 3.9084109687301645`*^9, 
  3.90858314956246*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"10597fba-f956-4ff3-b206-91d001fbf802"],

Cell[BoxData["c2"], "Output",
 CellChangeTimes->{3.8904274413601146`*^9, 3.8904313533311377`*^9, 
  3.8904334604679117`*^9, 3.890437337465905*^9, 3.9084109687301645`*^9, 
  3.908583149573157*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"47214e54-ed07-4145-bfd7-b1a300aec0e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"U1", "=", 
  RowBox[{"v", "-", 
   RowBox[{"t", " ", "x"}], " ", "+", " ", 
   RowBox[{"B1", "*", "s1"}], " ", "-", " ", "p1"}]}], "\[IndentingNewLine]", 
 RowBox[{"U2", "=", " ", 
  RowBox[{"v", " ", "-", " ", 
   RowBox[{"t", 
    RowBox[{"(", 
     RowBox[{"1", "-", "x"}], ")"}]}], " ", "+", " ", 
   RowBox[{"B2", "*", "s2"}], " ", "-", " ", "p2"}]}]}], "Input",
 CellChangeTimes->{{3.8695300907768693`*^9, 3.8695301263800807`*^9}, 
   3.869579799071973*^9, 3.869609191225527*^9, {3.8696125510492096`*^9, 
   3.8696126302865844`*^9}, {3.869612818878462*^9, 3.8696128356355124`*^9}, 
   3.869613193390823*^9, {3.8697562365427094`*^9, 3.869756251610731*^9}, {
   3.8697628619916663`*^9, 3.869762963389886*^9}, {3.869763351787159*^9, 
   3.8697633594165597`*^9}, {3.8830040363889456`*^9, 3.883004074181097*^9}, {
   3.8830941006726284`*^9, 3.8830941007316513`*^9}, {3.890427268493083*^9, 
   3.890427269473507*^9}, 3.890427364489101*^9, {3.8904274035236406`*^9, 
   3.890427434880097*^9}, {3.890431337865797*^9, 3.8904313422804556`*^9}, {
   3.908410870113207*^9, 3.9084108703365607`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"0a6f1011-e281-4793-9522-7dd973e105c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "p1"}], "+", 
  RowBox[{"B2", " ", "s1"}], "+", "v", "-", 
  RowBox[{"t", " ", "x"}]}]], "Output",
 CellChangeTimes->{3.890431355372236*^9, 3.8904334624022236`*^9, 
  3.8904373395236034`*^9, 3.908410971169641*^9, 3.908583151591149*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"80890e61-0d98-48fc-9761-33ed8fac71c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "p2"}], "+", 
  RowBox[{"B2", " ", "s2"}], "+", "v", "-", 
  RowBox[{"t", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "x"}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.890431355372236*^9, 3.8904334624022236`*^9, 
  3.8904373395236034`*^9, 3.908410971169641*^9, 3.908583151596757*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"527ce70e-db42-4bc1-b911-cce2777b5c01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "solve", " ", "for", " ", "the", " ", "indifference", " ", "point", " ", 
    "x", " ", "and", " ", "p2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"U1", " ", "==", "0"}], "&&", 
      RowBox[{"U2", "==", "0"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "p2"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8695301453692274`*^9, 3.869530157535555*^9}, {
   3.8696092341804557`*^9, 3.8696092352453747`*^9}, {3.8696097336504374`*^9, 
   3.869609738738426*^9}, {3.8696108110343056`*^9, 3.8696108268179197`*^9}, 
   3.869611031363312*^9, {3.86976306676859*^9, 3.8697630888908515`*^9}, 
   3.869763142750183*^9, {3.869763398600049*^9, 3.869763399827542*^9}, 
   3.883004047045802*^9, {3.890431345708068*^9, 3.890431348744961*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"cd31be75-b789-46c6-8ff8-f3259ef2005d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"p1", "-", 
        RowBox[{"B2", " ", "s1"}], "-", "v"}], "t"]}]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "p1"}], "+", 
      RowBox[{"B2", " ", "s1"}], "+", 
      RowBox[{"B2", " ", "s2"}], "-", "t", "+", 
      RowBox[{"2", " ", "v"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.86961083207405*^9, {3.8696110247848387`*^9, 3.8696110336058545`*^9}, 
   3.8696111188943567`*^9, 3.869611295560793*^9, 3.869612647972098*^9, 
   3.869613208167717*^9, 3.8696145558433523`*^9, 3.869664285740402*^9, 
   3.869665664850443*^9, 3.869756450473443*^9, {3.8697631526272526`*^9, 
   3.8697631811018596`*^9}, 3.8697635879039726`*^9, 3.869763854841522*^9, 
   3.873676993648179*^9, 3.873677292499292*^9, 3.87392263399831*^9, 
   3.873924769766781*^9, 3.8739248892129593`*^9, 3.873924977918748*^9, 
   3.8739250778743944`*^9, 3.8739259160523434`*^9, 3.873925973892874*^9, 
   3.873928324482807*^9, {3.88300395062951*^9, 3.8830039588490524`*^9}, 
   3.883004079026778*^9, 3.883004151388136*^9, 3.883004943207768*^9, 
   3.8830941079400167`*^9, 3.8904272893470516`*^9, 3.8904273804461975`*^9, 
   3.8904274450381126`*^9, 3.8904313577115507`*^9, 3.8904334642677493`*^9, 
   3.890437341241769*^9, 3.9084109739188404`*^9, 3.908583153679927*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"1f874be5-92d9-4b10-96eb-0fe7ccad07d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "represent", " ", "x", " ", "and", " ", "p2", " ", "using", " ", "p1"}], 
    ",", "s1", ",", "s2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"x", " ", "=", " ", 
    RowBox[{"x", "/.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"p2", "=", " ", 
    RowBox[{"p2", "/.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.869530190329769*^9, {3.8696092595452375`*^9, 3.8696092644306374`*^9}, {
   3.8696097347559023`*^9, 3.8696097404754868`*^9}, {3.8696101267727714`*^9, 
   3.8696101271298466`*^9}, {3.86961018708237*^9, 3.86961018754782*^9}, {
   3.86961124331281*^9, 3.8696112561446543`*^9}, {3.8696113115197325`*^9, 
   3.8696113224749126`*^9}, {3.869763472099374*^9, 3.86976353198735*^9}, {
   3.8697635632593584`*^9, 3.869763576400509*^9}, {3.8904313626873827`*^9, 
   3.890431365989398*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"1f2e9830-d623-4950-a117-58e34d7c6439"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"p1", "-", 
    RowBox[{"B2", " ", "s1"}], "-", "v"}], "t"]}]], "Output",
 CellChangeTimes->{
  3.8696097962775135`*^9, 3.8696101294982815`*^9, 3.8696102009970627`*^9, {
   3.869611285865676*^9, 3.8696113285809374`*^9}, 3.86961266717867*^9, 
   3.8696132125824986`*^9, 3.869614562916379*^9, 3.869664290584119*^9, 
   3.8696656698339195`*^9, 3.8697564552239428`*^9, 3.8697633044317293`*^9, 
   3.8697635903029776`*^9, 3.8697638569811835`*^9, 3.8736769960755763`*^9, 
   3.8736772949876223`*^9, 3.8739226366506433`*^9, 3.8739247723740416`*^9, 
   3.8739248913455544`*^9, 3.873924979870607*^9, 3.873925079410232*^9, 
   3.873925917816162*^9, 3.8739259807361865`*^9, 3.873928326540618*^9, 
   3.883003962108542*^9, 3.8830040804074717`*^9, 3.8830041529250565`*^9, 
   3.88300494466936*^9, 3.8830941119807377`*^9, 3.8904272909377823`*^9, 
   3.8904273825240707`*^9, 3.890427449582101*^9, 3.8904313680388126`*^9, 
   3.890433466160054*^9, 3.890437343896881*^9, 3.9084109758713183`*^9, 
   3.908583155316636*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"fde01372-1ec7-49ce-8b9e-f32f020872ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "p1"}], "+", 
  RowBox[{"B2", " ", "s1"}], "+", 
  RowBox[{"B2", " ", "s2"}], "-", "t", "+", 
  RowBox[{"2", " ", "v"}]}]], "Output",
 CellChangeTimes->{
  3.8696097962775135`*^9, 3.8696101294982815`*^9, 3.8696102009970627`*^9, {
   3.869611285865676*^9, 3.8696113285809374`*^9}, 3.86961266717867*^9, 
   3.8696132125824986`*^9, 3.869614562916379*^9, 3.869664290584119*^9, 
   3.8696656698339195`*^9, 3.8697564552239428`*^9, 3.8697633044317293`*^9, 
   3.8697635903029776`*^9, 3.8697638569811835`*^9, 3.8736769960755763`*^9, 
   3.8736772949876223`*^9, 3.8739226366506433`*^9, 3.8739247723740416`*^9, 
   3.8739248913455544`*^9, 3.873924979870607*^9, 3.873925079410232*^9, 
   3.873925917816162*^9, 3.8739259807361865`*^9, 3.873928326540618*^9, 
   3.883003962108542*^9, 3.8830040804074717`*^9, 3.8830041529250565`*^9, 
   3.88300494466936*^9, 3.8830941119807377`*^9, 3.8904272909377823`*^9, 
   3.8904273825240707`*^9, 3.890427449582101*^9, 3.8904313680388126`*^9, 
   3.890433466160054*^9, 3.890437343896881*^9, 3.9084109758713183`*^9, 
   3.90858315532244*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"bf68e676-0232-476d-838b-9ac89f1ac7a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"represent", " ", 
     RowBox[{"producers", "'"}], " ", "revenue", " ", "using", " ", "p1"}], 
    ",", "s1", ",", "s2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"R", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p1", "-", "k"}], ")"}], "*", "x"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p2", "-", "k"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "x"}], ")"}]}], "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c1", "*", 
        RowBox[{"s1", "^", "2"}]}], " ", "+", " ", 
       RowBox[{"c2", "*", 
        RowBox[{"s2", "^", "2"}]}]}], ")"}], "/", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.869530205598686*^9, 3.869530243292401*^9}, {
  3.8696092780715065`*^9, 3.8696093066206427`*^9}, {3.8696096706436405`*^9, 
  3.8696096726072397`*^9}, {3.86960981596585*^9, 3.869609824567789*^9}, {
  3.869609937108879*^9, 3.86960994550438*^9}, {3.869610234647156*^9, 
  3.8696102427341413`*^9}, {3.8697636016615314`*^9, 3.86976367510575*^9}, {
  3.8830041272658863`*^9, 3.883004145525016*^9}, {3.883006126832283*^9, 
  3.883006130942385*^9}, {3.8904272771851344`*^9, 3.890427279519074*^9}, {
  3.8904313732412214`*^9, 3.890431383636384*^9}, {3.908410874634094*^9, 
  3.9084108804303684`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"ff4334b3-3771-405b-987b-8f5552e0f5b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c2"}], " ", 
      SuperscriptBox["s1", "2"]}], "-", 
     RowBox[{"c2", " ", 
      SuperscriptBox["s2", "2"]}]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "k"}], "+", "p1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"p1", "-", 
      RowBox[{"B2", " ", "s1"}], "-", "v"}], ")"}]}], "t"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"p1", "-", 
       RowBox[{"B2", " ", "s1"}], "-", "v"}], "t"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k"}], "-", "p1", "+", 
     RowBox[{"B2", " ", "s1"}], "+", 
     RowBox[{"B2", " ", "s2"}], "-", "t", "+", 
     RowBox[{"2", " ", "v"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.890431385608841*^9, 3.8904334680343323`*^9, 
  3.8904373457955446`*^9, 3.90841097836436*^9, 3.9085831575572906`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"12bf8415-992c-4c34-b3ba-167fded5cb11"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["R"], "Input",
 CellChangeTimes->{{3.869530375207568*^9, 3.8695303800390472`*^9}, {
   3.8696093362476034`*^9, 3.8696093425629344`*^9}, {3.86960983473687*^9, 
   3.8696098350913897`*^9}, 3.890431389771265*^9},
 CellLabel->"In[71]:=",ExpressionUUID->"b3a33d57-9ee6-4587-8baf-f5a86fd40b71"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c2"}], " ", 
      SuperscriptBox["s1", "2"]}], "-", 
     RowBox[{"c2", " ", 
      SuperscriptBox["s2", "2"]}]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "k"}], "+", "p1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"p1", "-", 
      RowBox[{"B2", " ", "s1"}], "-", "v"}], ")"}]}], "t"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"p1", "-", 
       RowBox[{"B2", " ", "s1"}], "-", "v"}], "t"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k"}], "-", "p1", "+", 
     RowBox[{"B2", " ", "s1"}], "+", 
     RowBox[{"B2", " ", "s2"}], "-", "t", "+", 
     RowBox[{"2", " ", "v"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.8904313904668183`*^9, 3.890433470006203*^9, 
  3.890437347303971*^9, 3.908410981118448*^9, 3.9085831593723545`*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"2af7d1b5-3b87-4374-81e2-58fd27998438"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solve", " ", "the", " ", "optimal", " ", "solution", " ", "p1"}],
     ",", "p2", ",", "s1", ",", "s2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"R", ",", "p1"}], "]"}], "==", "0"}], "&&", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"R", ",", "s1"}], "]"}], "==", "0"}], "&&", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"R", ",", "s2"}], "]"}], "==", "0"}], " ", "&&", " ", 
      RowBox[{"U1", "==", "0"}], " ", "&&", " ", 
      RowBox[{"U2", "==", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "s1", ",", "s2"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8696641466818743`*^9, 3.869664146702901*^9}, {
   3.869664249915012*^9, 3.8696642735717154`*^9}, {3.869664321850009*^9, 
   3.869664324872761*^9}, {3.869763757707485*^9, 3.8697637841290283`*^9}, {
   3.8697638798344355`*^9, 3.8697638811846223`*^9}, 3.8736770116371193`*^9, {
   3.8736770672929487`*^9, 3.873677067788809*^9}, {3.890431412946334*^9, 
   3.890431442490472*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"4d4fcd40-4744-4e4a-81ec-5086e6bd88fa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["B2", "2"]}], "+", 
        RowBox[{"c2", " ", "t"}], "-", 
        RowBox[{"2", " ", "c2", " ", "v"}]}], 
       RowBox[{"2", " ", "c2"}]]}]}], ",", 
    RowBox[{"s1", "\[Rule]", 
     FractionBox["B2", 
      RowBox[{"2", " ", "c2"}]]}], ",", 
    RowBox[{"s2", "\[Rule]", 
     FractionBox["B2", 
      RowBox[{"2", " ", "c2"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8696643275407095`*^9, 3.8696656890691333`*^9, 3.869763725363578*^9, 
   3.869763786948697*^9, 3.869763901578745*^9, 3.873677014475707*^9, 
   3.873677071567312*^9, 3.8736773092428584`*^9, 3.873922648010298*^9, 
   3.8739247801638746`*^9, 3.873924897132349*^9, 3.873924991494689*^9, 
   3.873925085591449*^9, 3.873925924597663*^9, 3.873925996438487*^9, 
   3.873928333736892*^9, 3.88300399970224*^9, 3.8830040861073036`*^9, 
   3.8830041562004623`*^9, 3.8830049504243073`*^9, 3.883097444376753*^9, 
   3.890427299449773*^9, 3.890427388167345*^9, 3.8904274568812866`*^9, {
   3.89043142581141*^9, 3.890431444021135*^9}, 3.890433473541048*^9, 
   3.8904373488709016`*^9, 3.90841098362487*^9, 3.90858316180932*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"a49cfae6-3ed2-4e0f-9356-aa4735c036bc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "expression", " ", "for", " ", "optimal", " ", "price", " ", "p1", " ", 
   "and", " ", "p2"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8830042434923487`*^9, 
  3.883004253841714*^9}},ExpressionUUID->"6904230a-cd3c-4c69-af29-\
baa3e423ff92"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p1", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"p1", "/.", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.88300409693933*^9, 3.883004109517455*^9}, {
  3.883004177508803*^9, 3.8830041862577343`*^9}, {3.890427482762739*^9, 
  3.8904274873808455`*^9}, {3.890431463878793*^9, 3.89043146429593*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"53d84b96-a585-4c7c-ba38-fb20c3e8d0e2"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["B2", "2"], 
   RowBox[{"2", " ", "c2"}]], "-", 
  FractionBox["t", "2"], "+", "v"}]], "Output",
 CellChangeTimes->{
  3.883004111912456*^9, 3.8830042176388254`*^9, 3.883004952543344*^9, 
   3.8830974477500954`*^9, 3.8904273033560257`*^9, 3.8904273898268824`*^9, 
   3.890427461236537*^9, 3.890427495602513*^9, {3.8904314546925163`*^9, 
   3.890431464919055*^9}, 3.890433477128845*^9, 3.890437350847128*^9, 
   3.908410985815875*^9, 3.9085831640153885`*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"df426835-9043-425d-89c6-886bc3faf648"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "expression", " ", "for", " ", "optimal", " ", "CSR", " ", "investment", 
   " ", "s1", " ", "and", " ", "s2"}], "*)"}]], "Input",
 CellChangeTimes->{{3.88300426133843*^9, 
  3.8830042737866025`*^9}},ExpressionUUID->"18338a1f-e956-4c8b-815d-\
a792cfa7c07e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"s1", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"s1", "/.", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"s2", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"s2", "/.", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.88300411661967*^9, 3.883004117609563*^9}, {
  3.8830041907182293`*^9, 3.883004213007213*^9}, {3.8904274903238697`*^9, 
  3.890427493727515*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"2c46ca33-7d17-4b11-8e68-7ca355ceb04e"],

Cell[BoxData[
 FractionBox["B2", 
  RowBox[{"2", " ", "c2"}]]], "Output",
 CellChangeTimes->{3.8830042206561885`*^9, 3.8830049541938057`*^9, 
  3.8830974501279564`*^9, 3.8904273169461966`*^9, 3.8904273921798935`*^9, 
  3.890427463274216*^9, 3.8904274973279514`*^9, 3.890431469221287*^9, 
  3.890433479031034*^9, 3.890437352298388*^9, 3.9084109874433537`*^9, 
  3.908583166165473*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"1e16aaa5-a14d-44f0-add7-292e6f504109"],

Cell[BoxData[
 FractionBox["B2", 
  RowBox[{"2", " ", "c2"}]]], "Output",
 CellChangeTimes->{3.8830042206561885`*^9, 3.8830049541938057`*^9, 
  3.8830974501279564`*^9, 3.8904273169461966`*^9, 3.8904273921798935`*^9, 
  3.890427463274216*^9, 3.8904274973279514`*^9, 3.890431469221287*^9, 
  3.890433479031034*^9, 3.890437352298388*^9, 3.9084109874433537`*^9, 
  3.9085831661704936`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"a60291ed-b50e-4a55-b11b-1eb8c187a7ce"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"non", "-", 
   RowBox[{
   "green", " ", "and", " ", "green", " ", "market", " ", "share", " ", 
    "under", " ", "the", " ", "optimal", " ", "prices", " ", "and", " ", 
    "CSR", " ", "investment"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.883004279566414*^9, 3.8830043088108497`*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"2695a0b7-ba74-4663-831b-aa92c5ae972e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"x", "/.", 
   RowBox[{"sol", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"1", " ", "-", " ", "x"}], "/.", 
   RowBox[{"sol", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.873677079999561*^9, 3.8736772663353844`*^9}, {
  3.883004226666083*^9, 3.8830042275348654`*^9}, {3.8830043148292294`*^9, 
  3.883004337921043*^9}, {3.9084108866809225`*^9, 3.908410888728058*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"febd9de4-1bdb-4f90-8963-f735a9922e2a"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{{3.873677094753072*^9, 3.873677106991234*^9}, {
   3.8736771491287823`*^9, 3.8736771836921453`*^9}, {3.8736772214633055`*^9, 
   3.873677238033496*^9}, 3.873677268625588*^9, 3.873677312577612*^9, 
   3.8739226511412764`*^9, 3.873924783903401*^9, 3.873924901187361*^9, 
   3.873924994387364*^9, 3.8739250875743675`*^9, 3.873925928777547*^9, 
   3.8739260029361887`*^9, 3.873926528686367*^9, 3.8739283364845467`*^9, 
   3.8830040063783607`*^9, {3.883004323210495*^9, 3.883004339392295*^9}, 
   3.8830049571565175`*^9, 3.883097454168835*^9, 3.8904273211843104`*^9, 
   3.8904274648798656`*^9, 3.8904274995700674`*^9, 3.8904314720755863`*^9, 
   3.8904334811892834`*^9, 3.8904373537830944`*^9, 3.908410989441022*^9, 
   3.9085831682018595`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"ac76263d-ab86-4f33-8580-014dc2f35b23"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{{3.873677094753072*^9, 3.873677106991234*^9}, {
   3.8736771491287823`*^9, 3.8736771836921453`*^9}, {3.8736772214633055`*^9, 
   3.873677238033496*^9}, 3.873677268625588*^9, 3.873677312577612*^9, 
   3.8739226511412764`*^9, 3.873924783903401*^9, 3.873924901187361*^9, 
   3.873924994387364*^9, 3.8739250875743675`*^9, 3.873925928777547*^9, 
   3.8739260029361887`*^9, 3.873926528686367*^9, 3.8739283364845467`*^9, 
   3.8830040063783607`*^9, {3.883004323210495*^9, 3.883004339392295*^9}, 
   3.8830049571565175`*^9, 3.883097454168835*^9, 3.8904273211843104`*^9, 
   3.8904274648798656`*^9, 3.8904274995700674`*^9, 3.8904314720755863`*^9, 
   3.8904334811892834`*^9, 3.8904373537830944`*^9, 3.908410989441022*^9, 
   3.9085831682079525`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"17c7db71-78bc-4c86-b51b-7d5cff97f3c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "R", "]"}]], "Input",
 CellChangeTimes->{{3.890427324723546*^9, 3.890427340819708*^9}, {
  3.890431477106152*^9, 3.890431477327013*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"1b773877-4118-41db-a5cc-f3ac1f36c1e8"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["B2", "2"], 
   RowBox[{"4", " ", "c2"}]], "-", "k", "-", 
  FractionBox["t", "2"], "+", "v"}]], "Output",
 CellChangeTimes->{3.890437358421569*^9, 3.908410992223957*^9, 
  3.9085831704153457`*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"ce849770-9323-4b29-a0d6-32f949ba4a9f"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8904095159353213`*^9, 
  3.890409534071107*^9}},ExpressionUUID->"3740c19c-3741-47d7-9945-\
de2ccc19c2a7"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellLabel->"In[79]:=",ExpressionUUID->"6578ae90-4791-492f-a1c1-6252b151ffa1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"2", "N"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"B2", " ", "=", "B1"}], "\[IndentingNewLine]", 
   RowBox[{"c2", " ", "=", " ", "c1"}]}]}]], "Input",
 CellChangeTimes->{{3.890409453545866*^9, 3.8904094645415688`*^9}, 
   3.8904273497634907`*^9, {3.890433443072093*^9, 3.8904334515975714`*^9}, {
   3.8904335197445374`*^9, 3.8904335278251853`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"e6b2bf1a-1fd3-4f0f-925f-49c238940984"],

Cell[BoxData["B1"], "Output",
 CellChangeTimes->{3.890433550088229*^9, 3.8907850969315405`*^9, 
  3.9084109957392683`*^9, 3.908583219331959*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"e414bcb1-b71c-4964-9fbd-d6cd32f6bdd5"],

Cell[BoxData["c1"], "Output",
 CellChangeTimes->{3.890433550088229*^9, 3.8907850969315405`*^9, 
  3.9084109957392683`*^9, 3.908583219332964*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"43da876c-ed29-4929-9692-58d0628d67d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"U1", "=", 
  RowBox[{"v", "-", 
   RowBox[{"t", " ", "x"}], " ", "+", " ", 
   RowBox[{"B1", "*", "s1"}], " ", "-", " ", "p1"}]}], "\[IndentingNewLine]", 
 RowBox[{"U2", "=", " ", 
  RowBox[{"v", " ", "-", " ", 
   RowBox[{"t", 
    RowBox[{"(", 
     RowBox[{"1", "-", "x"}], ")"}]}], " ", "+", " ", 
   RowBox[{"B2", "*", "s2"}], " ", "-", " ", "p2"}]}]}], "Input",
 CellChangeTimes->{{3.8695300907768693`*^9, 3.8695301263800807`*^9}, 
   3.869579799071973*^9, 3.869609191225527*^9, {3.8696125510492096`*^9, 
   3.8696126302865844`*^9}, {3.869612818878462*^9, 3.8696128356355124`*^9}, 
   3.869613193390823*^9, {3.8697562365427094`*^9, 3.869756251610731*^9}, {
   3.8697628619916663`*^9, 3.869762963389886*^9}, {3.869763351787159*^9, 
   3.8697633594165597`*^9}, {3.8830040363889456`*^9, 3.883004074181097*^9}, {
   3.8830941006726284`*^9, 3.8830941007316513`*^9}, {3.890427268493083*^9, 
   3.890427269473507*^9}, 3.890427364489101*^9, {3.8904274035236406`*^9, 
   3.890427434880097*^9}, {3.890431337865797*^9, 3.8904313422804556`*^9}, {
   3.90841089950281*^9, 3.9084109000392647`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"8adf2bf0-d009-41fb-bbb7-0c9544918ce8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "p1"}], "+", 
  RowBox[{"B1", " ", "s1"}], "+", "v", "-", 
  RowBox[{"t", " ", "x"}]}]], "Output",
 CellChangeTimes->{3.890431355372236*^9, 3.8904334624022236`*^9, 
  3.890433552331483*^9, 3.8907850986056957`*^9, 3.9084109975408897`*^9, 
  3.908583221175656*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"c3e9a93b-5f40-482b-8b5c-311d2a1922b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "p2"}], "+", 
  RowBox[{"B1", " ", "s2"}], "+", "v", "-", 
  RowBox[{"t", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "x"}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.890431355372236*^9, 3.8904334624022236`*^9, 
  3.890433552331483*^9, 3.8907850986056957`*^9, 3.9084109975408897`*^9, 
  3.908583221178352*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"80bd4b02-2700-4f91-a0c5-89269e7967bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "solve", " ", "for", " ", "the", " ", "indifference", " ", "point", " ", 
    "x", " ", "and", " ", "p2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"U1", " ", "==", "0"}], "&&", 
      RowBox[{"U2", "==", "0"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "p2"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8695301453692274`*^9, 3.869530157535555*^9}, {
   3.8696092341804557`*^9, 3.8696092352453747`*^9}, {3.8696097336504374`*^9, 
   3.869609738738426*^9}, {3.8696108110343056`*^9, 3.8696108268179197`*^9}, 
   3.869611031363312*^9, {3.86976306676859*^9, 3.8697630888908515`*^9}, 
   3.869763142750183*^9, {3.869763398600049*^9, 3.869763399827542*^9}, 
   3.883004047045802*^9, {3.890431345708068*^9, 3.890431348744961*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"85eeabd9-dce6-4f45-a81c-869ff588d6c9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"p1", "-", 
        RowBox[{"B1", " ", "s1"}], "-", "v"}], "t"]}]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "p1"}], "+", 
      RowBox[{"B1", " ", "s1"}], "+", 
      RowBox[{"B1", " ", "s2"}], "-", "t", "+", 
      RowBox[{"2", " ", "v"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.86961083207405*^9, {3.8696110247848387`*^9, 3.8696110336058545`*^9}, 
   3.8696111188943567`*^9, 3.869611295560793*^9, 3.869612647972098*^9, 
   3.869613208167717*^9, 3.8696145558433523`*^9, 3.869664285740402*^9, 
   3.869665664850443*^9, 3.869756450473443*^9, {3.8697631526272526`*^9, 
   3.8697631811018596`*^9}, 3.8697635879039726`*^9, 3.869763854841522*^9, 
   3.873676993648179*^9, 3.873677292499292*^9, 3.87392263399831*^9, 
   3.873924769766781*^9, 3.8739248892129593`*^9, 3.873924977918748*^9, 
   3.8739250778743944`*^9, 3.8739259160523434`*^9, 3.873925973892874*^9, 
   3.873928324482807*^9, {3.88300395062951*^9, 3.8830039588490524`*^9}, 
   3.883004079026778*^9, 3.883004151388136*^9, 3.883004943207768*^9, 
   3.8830941079400167`*^9, 3.8904272893470516`*^9, 3.8904273804461975`*^9, 
   3.8904274450381126`*^9, 3.8904313577115507`*^9, 3.8904334642677493`*^9, 
   3.8904335540319295`*^9, 3.890785100430929*^9, 3.9084109999982586`*^9, 
   3.908583223646349*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"6ca02f58-29c5-409f-8495-eb79fdedd0d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "represent", " ", "x", " ", "and", " ", "p2", " ", "using", " ", "p1"}], 
    ",", "s1", ",", "s2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"x", " ", "=", " ", 
    RowBox[{"x", "/.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"p2", "=", " ", 
    RowBox[{"p2", "/.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.869530190329769*^9, {3.8696092595452375`*^9, 3.8696092644306374`*^9}, {
   3.8696097347559023`*^9, 3.8696097404754868`*^9}, {3.8696101267727714`*^9, 
   3.8696101271298466`*^9}, {3.86961018708237*^9, 3.86961018754782*^9}, {
   3.86961124331281*^9, 3.8696112561446543`*^9}, {3.8696113115197325`*^9, 
   3.8696113224749126`*^9}, {3.869763472099374*^9, 3.86976353198735*^9}, {
   3.8697635632593584`*^9, 3.869763576400509*^9}, {3.8904313626873827`*^9, 
   3.890431365989398*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"f4b173c8-e1fb-497a-a02f-88aca14539dd"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"p1", "-", 
    RowBox[{"B1", " ", "s1"}], "-", "v"}], "t"]}]], "Output",
 CellChangeTimes->{
  3.8696097962775135`*^9, 3.8696101294982815`*^9, 3.8696102009970627`*^9, {
   3.869611285865676*^9, 3.8696113285809374`*^9}, 3.86961266717867*^9, 
   3.8696132125824986`*^9, 3.869614562916379*^9, 3.869664290584119*^9, 
   3.8696656698339195`*^9, 3.8697564552239428`*^9, 3.8697633044317293`*^9, 
   3.8697635903029776`*^9, 3.8697638569811835`*^9, 3.8736769960755763`*^9, 
   3.8736772949876223`*^9, 3.8739226366506433`*^9, 3.8739247723740416`*^9, 
   3.8739248913455544`*^9, 3.873924979870607*^9, 3.873925079410232*^9, 
   3.873925917816162*^9, 3.8739259807361865`*^9, 3.873928326540618*^9, 
   3.883003962108542*^9, 3.8830040804074717`*^9, 3.8830041529250565`*^9, 
   3.88300494466936*^9, 3.8830941119807377`*^9, 3.8904272909377823`*^9, 
   3.8904273825240707`*^9, 3.890427449582101*^9, 3.8904313680388126`*^9, 
   3.890433466160054*^9, 3.890433555755401*^9, 3.890785101915759*^9, 
   3.9084110020269065`*^9, 3.908583225414039*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"2481c2ec-ac66-48ff-aec4-8a43b3bd798d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "p1"}], "+", 
  RowBox[{"B1", " ", "s1"}], "+", 
  RowBox[{"B1", " ", "s2"}], "-", "t", "+", 
  RowBox[{"2", " ", "v"}]}]], "Output",
 CellChangeTimes->{
  3.8696097962775135`*^9, 3.8696101294982815`*^9, 3.8696102009970627`*^9, {
   3.869611285865676*^9, 3.8696113285809374`*^9}, 3.86961266717867*^9, 
   3.8696132125824986`*^9, 3.869614562916379*^9, 3.869664290584119*^9, 
   3.8696656698339195`*^9, 3.8697564552239428`*^9, 3.8697633044317293`*^9, 
   3.8697635903029776`*^9, 3.8697638569811835`*^9, 3.8736769960755763`*^9, 
   3.8736772949876223`*^9, 3.8739226366506433`*^9, 3.8739247723740416`*^9, 
   3.8739248913455544`*^9, 3.873924979870607*^9, 3.873925079410232*^9, 
   3.873925917816162*^9, 3.8739259807361865`*^9, 3.873928326540618*^9, 
   3.883003962108542*^9, 3.8830040804074717`*^9, 3.8830041529250565`*^9, 
   3.88300494466936*^9, 3.8830941119807377`*^9, 3.8904272909377823`*^9, 
   3.8904273825240707`*^9, 3.890427449582101*^9, 3.8904313680388126`*^9, 
   3.890433466160054*^9, 3.890433555755401*^9, 3.890785101915759*^9, 
   3.9084110020269065`*^9, 3.908583225422152*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"8288d6a2-3c2d-4849-8d50-c9d76349bf8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"represent", " ", 
     RowBox[{"producers", "'"}], " ", "revenue", " ", "using", " ", "p1"}], 
    ",", "s1", ",", "s2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"R", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "p1", ")"}], "*", "x"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", "p2", ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "x"}], ")"}]}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c1", "*", 
        RowBox[{"s1", "^", "2"}]}], " ", "+", " ", 
       RowBox[{"c2", "*", 
        RowBox[{"s2", "^", "2"}]}]}], ")"}], "/", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.869530205598686*^9, 3.869530243292401*^9}, {
  3.8696092780715065`*^9, 3.8696093066206427`*^9}, {3.8696096706436405`*^9, 
  3.8696096726072397`*^9}, {3.86960981596585*^9, 3.869609824567789*^9}, {
  3.869609937108879*^9, 3.86960994550438*^9}, {3.869610234647156*^9, 
  3.8696102427341413`*^9}, {3.8697636016615314`*^9, 3.86976367510575*^9}, {
  3.8830041272658863`*^9, 3.883004145525016*^9}, {3.883006126832283*^9, 
  3.883006130942385*^9}, {3.8904272771851344`*^9, 3.890427279519074*^9}, {
  3.8904313732412214`*^9, 3.890431383636384*^9}, {3.890785084009281*^9, 
  3.890785086960755*^9}, {3.908410909921815*^9, 3.908410913546892*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"2021d52f-e39c-4e9b-ac99-9d4c36f66167"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c1"}], " ", 
      SuperscriptBox["s1", "2"]}], "-", 
     RowBox[{"c1", " ", 
      SuperscriptBox["s2", "2"]}]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"p1", " ", 
    RowBox[{"(", 
     RowBox[{"p1", "-", 
      RowBox[{"B1", " ", "s1"}], "-", "v"}], ")"}]}], "t"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"p1", "-", 
       RowBox[{"B1", " ", "s1"}], "-", "v"}], "t"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "p1"}], "+", 
     RowBox[{"B1", " ", "s1"}], "+", 
     RowBox[{"B1", " ", "s2"}], "-", "t", "+", 
     RowBox[{"2", " ", "v"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.890431385608841*^9, 3.8904334680343323`*^9, 
  3.890433558579135*^9, 3.8907851038257236`*^9, 3.9084110043173428`*^9, 
  3.908583227162425*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"ad877eb2-ea0a-4a5c-83dd-956a65c1fd19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["R"], "Input",
 CellChangeTimes->{{3.869530375207568*^9, 3.8695303800390472`*^9}, {
   3.8696093362476034`*^9, 3.8696093425629344`*^9}, {3.86960983473687*^9, 
   3.8696098350913897`*^9}, 3.890431389771265*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"eecee717-16f6-4beb-b93b-88da2b071107"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c1"}], " ", 
      SuperscriptBox["s1", "2"]}], "-", 
     RowBox[{"c1", " ", 
      SuperscriptBox["s2", "2"]}]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"p1", " ", 
    RowBox[{"(", 
     RowBox[{"p1", "-", 
      RowBox[{"B1", " ", "s1"}], "-", "v"}], ")"}]}], "t"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"p1", "-", 
       RowBox[{"B1", " ", "s1"}], "-", "v"}], "t"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "p1"}], "+", 
     RowBox[{"B1", " ", "s1"}], "+", 
     RowBox[{"B1", " ", "s2"}], "-", "t", "+", 
     RowBox[{"2", " ", "v"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.8904313904668183`*^9, 3.890433470006203*^9, 
  3.890433560361559*^9, 3.8907851059647017`*^9, 3.908411006554718*^9, 
  3.908583229817989*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"b2123523-adbf-4f84-94b5-6a226dd6cf65"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solve", " ", "the", " ", "optimal", " ", "solution", " ", "p1"}],
     ",", "p2", ",", "s1", ",", "s2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"R", ",", "p1"}], "]"}], "==", "0"}], "&&", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"R", ",", "s1"}], "]"}], "==", "0"}], "&&", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"R", ",", "s2"}], "]"}], "==", "0"}], " ", "&&", " ", 
      RowBox[{"U1", "==", "0"}], " ", "&&", " ", 
      RowBox[{"U2", "==", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "s1", ",", "s2"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8696641466818743`*^9, 3.869664146702901*^9}, {
   3.869664249915012*^9, 3.8696642735717154`*^9}, {3.869664321850009*^9, 
   3.869664324872761*^9}, {3.869763757707485*^9, 3.8697637841290283`*^9}, {
   3.8697638798344355`*^9, 3.8697638811846223`*^9}, 3.8736770116371193`*^9, {
   3.8736770672929487`*^9, 3.873677067788809*^9}, {3.890431412946334*^9, 
   3.890431442490472*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"e1d2f6e8-e580-4830-8ce7-cec100361ecb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["B1", "2"]}], "+", 
        RowBox[{"c1", " ", "t"}], "-", 
        RowBox[{"2", " ", "c1", " ", "v"}]}], 
       RowBox[{"2", " ", "c1"}]]}]}], ",", 
    RowBox[{"s1", "\[Rule]", 
     FractionBox["B1", 
      RowBox[{"2", " ", "c1"}]]}], ",", 
    RowBox[{"s2", "\[Rule]", 
     FractionBox["B1", 
      RowBox[{"2", " ", "c1"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8696643275407095`*^9, 3.8696656890691333`*^9, 3.869763725363578*^9, 
   3.869763786948697*^9, 3.869763901578745*^9, 3.873677014475707*^9, 
   3.873677071567312*^9, 3.8736773092428584`*^9, 3.873922648010298*^9, 
   3.8739247801638746`*^9, 3.873924897132349*^9, 3.873924991494689*^9, 
   3.873925085591449*^9, 3.873925924597663*^9, 3.873925996438487*^9, 
   3.873928333736892*^9, 3.88300399970224*^9, 3.8830040861073036`*^9, 
   3.8830041562004623`*^9, 3.8830049504243073`*^9, 3.883097444376753*^9, 
   3.890427299449773*^9, 3.890427388167345*^9, 3.8904274568812866`*^9, {
   3.89043142581141*^9, 3.890431444021135*^9}, 3.890433473541048*^9, 
   3.8904335622274847`*^9, 3.8907851118914623`*^9, 3.9084110095109744`*^9, 
   3.908583232226577*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"ae528b17-fe54-4c20-b6c3-d1041ae6cba4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "expression", " ", "for", " ", "optimal", " ", "price", " ", "p1", " ", 
   "and", " ", "p2"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8830042434923487`*^9, 
  3.883004253841714*^9}},ExpressionUUID->"8ed367be-4c69-4474-a66a-\
887b9a324df8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p1", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"p1", "/.", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.88300409693933*^9, 3.883004109517455*^9}, {
  3.883004177508803*^9, 3.8830041862577343`*^9}, {3.890427482762739*^9, 
  3.8904274873808455`*^9}, {3.890431463878793*^9, 3.89043146429593*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"e83a079b-c555-4783-907b-d538c525419a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["B1", "2"], 
   RowBox[{"2", " ", "c1"}]], "-", 
  FractionBox["t", "2"], "+", "v"}]], "Output",
 CellChangeTimes->{
  3.883004111912456*^9, 3.8830042176388254`*^9, 3.883004952543344*^9, 
   3.8830974477500954`*^9, 3.8904273033560257`*^9, 3.8904273898268824`*^9, 
   3.890427461236537*^9, 3.890427495602513*^9, {3.8904314546925163`*^9, 
   3.890431464919055*^9}, 3.890433477128845*^9, 3.8904335639432936`*^9, 
   3.8907851160070105`*^9, 3.908411011172742*^9, 3.908583234301951*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"ff3862ac-3700-4ca2-9c61-c027edb73204"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "expression", " ", "for", " ", "optimal", " ", "CSR", " ", "investment", 
   " ", "s1", " ", "and", " ", "s2"}], "*)"}]], "Input",
 CellChangeTimes->{{3.88300426133843*^9, 
  3.8830042737866025`*^9}},ExpressionUUID->"cfb93d92-b5b5-4abd-9184-\
215b7f2666e2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"s1", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"s1", "/.", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"s2", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"s2", "/.", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.88300411661967*^9, 3.883004117609563*^9}, {
  3.8830041907182293`*^9, 3.883004213007213*^9}, {3.8904274903238697`*^9, 
  3.890427493727515*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"adb38cb1-a5c6-4b5c-9f4d-ca1bc2daa866"],

Cell[BoxData[
 FractionBox["B1", 
  RowBox[{"2", " ", "c1"}]]], "Output",
 CellChangeTimes->{3.8830042206561885`*^9, 3.8830049541938057`*^9, 
  3.8830974501279564`*^9, 3.8904273169461966`*^9, 3.8904273921798935`*^9, 
  3.890427463274216*^9, 3.8904274973279514`*^9, 3.890431469221287*^9, 
  3.890433479031034*^9, 3.89043356560989*^9, 3.890785117843768*^9, 
  3.908411012773044*^9, 3.908583236101107*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"ffa0e9e0-fc16-44ee-bbc4-942eb274654b"],

Cell[BoxData[
 FractionBox["B1", 
  RowBox[{"2", " ", "c1"}]]], "Output",
 CellChangeTimes->{3.8830042206561885`*^9, 3.8830049541938057`*^9, 
  3.8830974501279564`*^9, 3.8904273169461966`*^9, 3.8904273921798935`*^9, 
  3.890427463274216*^9, 3.8904274973279514`*^9, 3.890431469221287*^9, 
  3.890433479031034*^9, 3.89043356560989*^9, 3.890785117843768*^9, 
  3.908411012773044*^9, 3.9085832361085324`*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"16261c2b-5956-4fd4-8cf0-1b434dc4134b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"non", "-", 
   RowBox[{
   "green", " ", "and", " ", "green", " ", "market", " ", "share", " ", 
    "under", " ", "the", " ", "optimal", " ", "prices", " ", "and", " ", 
    "CSR", " ", "investment"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.883004279566414*^9, 3.8830043088108497`*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"8226e997-d64d-4615-9920-717ea9088087"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"x", "/.", 
   RowBox[{"sol", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"1", " ", "-", " ", "x"}], "/.", 
   RowBox[{"sol", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.873677079999561*^9, 3.8736772663353844`*^9}, {
  3.883004226666083*^9, 3.8830042275348654`*^9}, {3.8830043148292294`*^9, 
  3.883004337921043*^9}, {3.9084109194348135`*^9, 3.9084109213640013`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"019b575b-d3b7-402e-a6b5-98392b779508"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{{3.873677094753072*^9, 3.873677106991234*^9}, {
   3.8736771491287823`*^9, 3.8736771836921453`*^9}, {3.8736772214633055`*^9, 
   3.873677238033496*^9}, 3.873677268625588*^9, 3.873677312577612*^9, 
   3.8739226511412764`*^9, 3.873924783903401*^9, 3.873924901187361*^9, 
   3.873924994387364*^9, 3.8739250875743675`*^9, 3.873925928777547*^9, 
   3.8739260029361887`*^9, 3.873926528686367*^9, 3.8739283364845467`*^9, 
   3.8830040063783607`*^9, {3.883004323210495*^9, 3.883004339392295*^9}, 
   3.8830049571565175`*^9, 3.883097454168835*^9, 3.8904273211843104`*^9, 
   3.8904274648798656`*^9, 3.8904274995700674`*^9, 3.8904314720755863`*^9, 
   3.8904334811892834`*^9, 3.890433567647089*^9, 3.890785119671248*^9, 
   3.908411014540227*^9, 3.9085832379689913`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"3b8925b3-405e-4374-8578-d542aa41d0c2"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{{3.873677094753072*^9, 3.873677106991234*^9}, {
   3.8736771491287823`*^9, 3.8736771836921453`*^9}, {3.8736772214633055`*^9, 
   3.873677238033496*^9}, 3.873677268625588*^9, 3.873677312577612*^9, 
   3.8739226511412764`*^9, 3.873924783903401*^9, 3.873924901187361*^9, 
   3.873924994387364*^9, 3.8739250875743675`*^9, 3.873925928777547*^9, 
   3.8739260029361887`*^9, 3.873926528686367*^9, 3.8739283364845467`*^9, 
   3.8830040063783607`*^9, {3.883004323210495*^9, 3.883004339392295*^9}, 
   3.8830049571565175`*^9, 3.883097454168835*^9, 3.8904273211843104`*^9, 
   3.8904274648798656`*^9, 3.8904274995700674`*^9, 3.8904314720755863`*^9, 
   3.8904334811892834`*^9, 3.890433567647089*^9, 3.890785119671248*^9, 
   3.908411014540227*^9, 3.90858323797517*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"b92b9e59-e235-4bb7-a2df-b89cc977c8e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "R", "]"}]], "Input",
 CellChangeTimes->{{3.890427324723546*^9, 3.890427340819708*^9}, {
  3.890431477106152*^9, 3.890431477327013*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"60107f63-8823-4fd7-af16-e70979515bb0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["B1", "2"], 
   RowBox[{"4", " ", "c1"}]], "-", 
  FractionBox["t", "2"], "+", "v"}]], "Output",
 CellChangeTimes->{3.890433576628207*^9, 3.890785122983776*^9, 
  3.90841101689542*^9, 3.908583240195043*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"e1b4804d-6ef9-4267-86ca-527f63b68197"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.890433646723441*^9, 
  3.890433647389642*^9}},ExpressionUUID->"88609aca-a373-4c92-914f-\
70eda3925393"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"clean", " ", "all", " ", "exsiting", " ", "variables"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.8695300907768693`*^9, 3.8695301263800807`*^9}, 
   3.869579799071973*^9, 3.869609191225527*^9, {3.8696125510492096`*^9, 
   3.8696126302865844`*^9}, {3.869612818878462*^9, 3.8696128356355124`*^9}, 
   3.869613193390823*^9, {3.8697562365427094`*^9, 3.869756251610731*^9}, {
   3.8697628619916663`*^9, 3.869762963389886*^9}, {3.869763351787159*^9, 
   3.8697633594165597`*^9}, 3.873922615424223*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"242f3857-fbea-498e-96aa-4fabaa316fc2"],

Cell[BoxData[
 RowBox[{"(*", "GN", "*)"}]], "Input",
 CellChangeTimes->{{3.8904336551348915`*^9, 
  3.890433658399223*^9}},ExpressionUUID->"1be1d32e-42fd-476d-abab-\
97ab14046ba3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"define", " ", 
      RowBox[{"consumer", "'"}], "s", " ", "utility", " ", "1"}], "=", 
     "\"\<Non-Green\>\""}], ",", " ", 
    RowBox[{"2", "=", "\"\<Green\>\""}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"U1", "=", 
    RowBox[{"v", "-", 
     RowBox[{"t", " ", "x"}], " ", "+", " ", 
     RowBox[{"B1", "*", "s1"}], " ", "-", " ", "p1"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"U2", "=", " ", 
    RowBox[{"v", " ", "-", " ", 
     RowBox[{"t", 
      RowBox[{"(", 
       RowBox[{"1", "-", "x"}], ")"}]}], " ", "+", " ", 
     RowBox[{"B2", "*", "s2"}], " ", "-", " ", "p2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8695300907768693`*^9, 3.8695301263800807`*^9}, 
   3.869579799071973*^9, 3.869609191225527*^9, {3.8696125510492096`*^9, 
   3.8696126302865844`*^9}, {3.869612818878462*^9, 3.8696128356355124`*^9}, 
   3.869613193390823*^9, {3.8697562365427094`*^9, 3.869756251610731*^9}, {
   3.8697628619916663`*^9, 3.869762963389886*^9}, {3.869763351787159*^9, 
   3.8697633594165597`*^9}, {3.8830040363889456`*^9, 3.883004074181097*^9}, {
   3.8830941006726284`*^9, 3.8830941007316513`*^9}, {3.8904336941081696`*^9, 
   3.890433697508359*^9}, {3.9084109266590567`*^9, 3.908410926836485*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"ae968bed-d977-4aed-aa90-4b912cfab27a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "p1"}], "+", 
  RowBox[{"B1", " ", "s1"}], "+", "v", "-", 
  RowBox[{"t", " ", "x"}]}]], "Output",
 CellChangeTimes->{3.890433705186513*^9, 3.8904374318841467`*^9, 
  3.8907851312613153`*^9, 3.9084110217753725`*^9, 3.9085824008607855`*^9, 
  3.908583048100891*^9, 3.908583261289792*^9, 3.908583563012842*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"7f6fc716-25f0-40e9-8a03-05b1c5930c5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "p2"}], "+", 
  RowBox[{"B2", " ", "s2"}], "+", "v", "-", 
  RowBox[{"t", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "x"}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.890433705186513*^9, 3.8904374318841467`*^9, 
  3.8907851312613153`*^9, 3.9084110217753725`*^9, 3.9085824008607855`*^9, 
  3.908583048100891*^9, 3.908583261289792*^9, 3.9085835630231056`*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"fff94c51-f808-4e64-b3e7-ed80208ece2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "solve", " ", "for", " ", "the", " ", "indifference", " ", "point", " ", 
    "x", " ", "and", " ", "p2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"U1", " ", "==", "0"}], "&&", 
      RowBox[{"U2", "==", "0"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "p2"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8695301453692274`*^9, 3.869530157535555*^9}, {
   3.8696092341804557`*^9, 3.8696092352453747`*^9}, {3.8696097336504374`*^9, 
   3.869609738738426*^9}, {3.8696108110343056`*^9, 3.8696108268179197`*^9}, 
   3.869611031363312*^9, {3.86976306676859*^9, 3.8697630888908515`*^9}, 
   3.869763142750183*^9, {3.869763398600049*^9, 3.869763399827542*^9}, 
   3.883004047045802*^9, {3.8904336999660406`*^9, 3.89043370288881*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"62ed3067-3889-4dcf-bfce-f6ff2ffa65a0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"p1", "-", 
        RowBox[{"B1", " ", "s1"}], "-", "v"}], "t"]}]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "p1"}], "+", 
      RowBox[{"B1", " ", "s1"}], "+", 
      RowBox[{"B2", " ", "s2"}], "-", "t", "+", 
      RowBox[{"2", " ", "v"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.86961083207405*^9, {3.8696110247848387`*^9, 3.8696110336058545`*^9}, 
   3.8696111188943567`*^9, 3.869611295560793*^9, 3.869612647972098*^9, 
   3.869613208167717*^9, 3.8696145558433523`*^9, 3.869664285740402*^9, 
   3.869665664850443*^9, 3.869756450473443*^9, {3.8697631526272526`*^9, 
   3.8697631811018596`*^9}, 3.8697635879039726`*^9, 3.869763854841522*^9, 
   3.873676993648179*^9, 3.873677292499292*^9, 3.87392263399831*^9, 
   3.873924769766781*^9, 3.8739248892129593`*^9, 3.873924977918748*^9, 
   3.8739250778743944`*^9, 3.8739259160523434`*^9, 3.873925973892874*^9, 
   3.873928324482807*^9, {3.88300395062951*^9, 3.8830039588490524`*^9}, 
   3.883004079026778*^9, 3.883004151388136*^9, 3.883004943207768*^9, 
   3.8830941079400167`*^9, 3.890433707422984*^9, 3.890437433620064*^9, 
   3.8907851333847*^9, 3.9084110235863395`*^9, 3.9085824026518764`*^9, 
   3.9085830508468924`*^9, 3.9085832633847256`*^9, 3.9085835653248234`*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"f5f3d9ef-9b09-437b-802c-4f0cdb59c73b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "represent", " ", "x", " ", "and", " ", "p2", " ", "using", " ", "p1"}], 
    ",", "s1", ",", "s2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"x", " ", "=", " ", 
    RowBox[{"x", "/.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"p2", "=", " ", 
    RowBox[{"p2", "/.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.869530190329769*^9, {3.8696092595452375`*^9, 3.8696092644306374`*^9}, {
   3.8696097347559023`*^9, 3.8696097404754868`*^9}, {3.8696101267727714`*^9, 
   3.8696101271298466`*^9}, {3.86961018708237*^9, 3.86961018754782*^9}, {
   3.86961124331281*^9, 3.8696112561446543`*^9}, {3.8696113115197325`*^9, 
   3.8696113224749126`*^9}, {3.869763472099374*^9, 3.86976353198735*^9}, {
   3.8697635632593584`*^9, 3.869763576400509*^9}, {3.8904337099676433`*^9, 
   3.89043371509511*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"260644d1-2d39-4848-bfad-a67a32e5f7ec"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"p1", "-", 
    RowBox[{"B1", " ", "s1"}], "-", "v"}], "t"]}]], "Output",
 CellChangeTimes->{
  3.8696097962775135`*^9, 3.8696101294982815`*^9, 3.8696102009970627`*^9, {
   3.869611285865676*^9, 3.8696113285809374`*^9}, 3.86961266717867*^9, 
   3.8696132125824986`*^9, 3.869614562916379*^9, 3.869664290584119*^9, 
   3.8696656698339195`*^9, 3.8697564552239428`*^9, 3.8697633044317293`*^9, 
   3.8697635903029776`*^9, 3.8697638569811835`*^9, 3.8736769960755763`*^9, 
   3.8736772949876223`*^9, 3.8739226366506433`*^9, 3.8739247723740416`*^9, 
   3.8739248913455544`*^9, 3.873924979870607*^9, 3.873925079410232*^9, 
   3.873925917816162*^9, 3.8739259807361865`*^9, 3.873928326540618*^9, 
   3.883003962108542*^9, 3.8830040804074717`*^9, 3.8830041529250565`*^9, 
   3.88300494466936*^9, 3.8830941119807377`*^9, 3.890433715733513*^9, 
   3.890437435240043*^9, 3.890785135011133*^9, 3.908411025277405*^9, 
   3.90858240461856*^9, 3.90858305237169*^9, 3.908583265118843*^9, 
   3.9085835672640314`*^9},
 CellLabel->
  "Out[137]=",ExpressionUUID->"09355ae0-1064-4249-9f05-9b97d5a7f4e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "p1"}], "+", 
  RowBox[{"B1", " ", "s1"}], "+", 
  RowBox[{"B2", " ", "s2"}], "-", "t", "+", 
  RowBox[{"2", " ", "v"}]}]], "Output",
 CellChangeTimes->{
  3.8696097962775135`*^9, 3.8696101294982815`*^9, 3.8696102009970627`*^9, {
   3.869611285865676*^9, 3.8696113285809374`*^9}, 3.86961266717867*^9, 
   3.8696132125824986`*^9, 3.869614562916379*^9, 3.869664290584119*^9, 
   3.8696656698339195`*^9, 3.8697564552239428`*^9, 3.8697633044317293`*^9, 
   3.8697635903029776`*^9, 3.8697638569811835`*^9, 3.8736769960755763`*^9, 
   3.8736772949876223`*^9, 3.8739226366506433`*^9, 3.8739247723740416`*^9, 
   3.8739248913455544`*^9, 3.873924979870607*^9, 3.873925079410232*^9, 
   3.873925917816162*^9, 3.8739259807361865`*^9, 3.873928326540618*^9, 
   3.883003962108542*^9, 3.8830040804074717`*^9, 3.8830041529250565`*^9, 
   3.88300494466936*^9, 3.8830941119807377`*^9, 3.890433715733513*^9, 
   3.890437435240043*^9, 3.890785135011133*^9, 3.908411025277405*^9, 
   3.90858240461856*^9, 3.90858305237169*^9, 3.908583265118843*^9, 
   3.9085835672739058`*^9},
 CellLabel->
  "Out[138]=",ExpressionUUID->"971a7cb8-14c6-4a3b-a37b-89ab744f7c62"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"represent", " ", 
     RowBox[{"producers", "'"}], " ", "revenue", " ", "using", " ", "p1"}], 
    ",", "s1", ",", "s2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"R", "=", " ", 
   RowBox[{
    RowBox[{"p1", "*", "x"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p2", "-", "k"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "x"}], ")"}]}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c1", "*", 
        RowBox[{"s1", "^", "2"}]}], " ", "+", " ", 
       RowBox[{"c2", "*", 
        RowBox[{"s2", "^", "2"}]}]}], ")"}], "/", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.869530205598686*^9, 3.869530243292401*^9}, {
  3.8696092780715065`*^9, 3.8696093066206427`*^9}, {3.8696096706436405`*^9, 
  3.8696096726072397`*^9}, {3.86960981596585*^9, 3.869609824567789*^9}, {
  3.869609937108879*^9, 3.86960994550438*^9}, {3.869610234647156*^9, 
  3.8696102427341413`*^9}, {3.8697636016615314`*^9, 3.86976367510575*^9}, {
  3.8830041272658863`*^9, 3.883004145525016*^9}, {3.883006126832283*^9, 
  3.883006130942385*^9}, {3.890433719709652*^9, 3.890433738223073*^9}, {
  3.9084109320360417`*^9, 3.908410938678583*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"8c24a6cc-1450-4489-932c-054367552ba7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c1"}], " ", 
      SuperscriptBox["s1", "2"]}], "-", 
     RowBox[{"c2", " ", 
      SuperscriptBox["s2", "2"]}]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"p1", " ", 
    RowBox[{"(", 
     RowBox[{"p1", "-", 
      RowBox[{"B1", " ", "s1"}], "-", "v"}], ")"}]}], "t"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"p1", "-", 
       RowBox[{"B1", " ", "s1"}], "-", "v"}], "t"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k"}], "-", "p1", "+", 
     RowBox[{"B1", " ", "s1"}], "+", 
     RowBox[{"B2", " ", "s2"}], "-", "t", "+", 
     RowBox[{"2", " ", "v"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8904337202223687`*^9, 3.890433742381666*^9}, 
   3.8904374369056964`*^9, 3.8907851368088818`*^9, 3.9084110275190125`*^9, 
   3.90858240656765*^9, 3.908583054480899*^9, 3.9085832672401395`*^9, 
   3.9085835691673536`*^9},
 CellLabel->
  "Out[139]=",ExpressionUUID->"1ae77f06-4f92-4762-83c3-95bf6097ec98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["R"], "Input",
 CellChangeTimes->{{3.869530375207568*^9, 3.8695303800390472`*^9}, {
  3.8696093362476034`*^9, 3.8696093425629344`*^9}, {3.86960983473687*^9, 
  3.8696098350913897`*^9}, {3.890433722516876*^9, 3.8904337239575214`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"e504e13a-12d8-4d68-8ae2-871be96020f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c1"}], " ", 
      SuperscriptBox["s1", "2"]}], "-", 
     RowBox[{"c2", " ", 
      SuperscriptBox["s2", "2"]}]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"p1", " ", 
    RowBox[{"(", 
     RowBox[{"p1", "-", 
      RowBox[{"B1", " ", "s1"}], "-", "v"}], ")"}]}], "t"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"p1", "-", 
       RowBox[{"B1", " ", "s1"}], "-", "v"}], "t"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k"}], "-", "p1", "+", 
     RowBox[{"B1", " ", "s1"}], "+", 
     RowBox[{"B2", " ", "s2"}], "-", "t", "+", 
     RowBox[{"2", " ", "v"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.873677299746135*^9, 3.873922642869034*^9, 3.8739247773309393`*^9, 
   3.8739248947173185`*^9, 3.87392498881102*^9, 3.8739250833542204`*^9, 
   3.8739259220344973`*^9, 3.873925986936863*^9, 3.8739283310175843`*^9, 
   3.883003970262563*^9, 3.883004083994191*^9, 3.8830049484721384`*^9, 
   3.883097440600869*^9, {3.890433724425648*^9, 3.8904337447748656`*^9}, 
   3.8904374385586762`*^9, 3.89078513914124*^9, 3.9084110296520224`*^9, 
   3.908582409178858*^9, 3.908583058556269*^9, 3.908583269713296*^9, 
   3.908583571151081*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"eb93f7f1-596f-4a29-9227-2fb37a71e720"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solve", " ", "the", " ", "optimal", " ", "solution", " ", "p1"}],
     ",", "p2", ",", "s1", ",", "s2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"R", ",", "p1"}], "]"}], "==", "0"}], "&&", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"R", ",", "s1"}], "]"}], "==", "0"}], "&&", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"R", ",", "s2"}], "]"}], "==", "0"}], " ", "&&", " ", 
      RowBox[{"U1", "==", "0"}], " ", "&&", " ", 
      RowBox[{"U2", "==", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "s1", ",", "s2"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8696641466818743`*^9, 3.869664146702901*^9}, {
   3.869664249915012*^9, 3.8696642735717154`*^9}, {3.869664321850009*^9, 
   3.869664324872761*^9}, {3.869763757707485*^9, 3.8697637841290283`*^9}, {
   3.8697638798344355`*^9, 3.8697638811846223`*^9}, 3.8736770116371193`*^9, {
   3.8736770672929487`*^9, 3.873677067788809*^9}, {3.8904337515770535`*^9, 
   3.8904337703454714`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"e040cd1a-8d97-49fc-8aba-c1dd158a7e66"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["B1", "2"]}], " ", 
         SuperscriptBox["B2", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["B1", "2"], " ", "c2", " ", "k"}], "+", 
        RowBox[{
         SuperscriptBox["B2", "2"], " ", "c1", " ", "t"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["B1", "2"], " ", "c2", " ", "t"}], "-", 
        RowBox[{"c1", " ", "c2", " ", "k", " ", "t"}], "-", 
        RowBox[{"2", " ", "c1", " ", "c2", " ", 
         SuperscriptBox["t", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["B2", "2"], " ", "c1", " ", "v"}], "-", 
        RowBox[{
         SuperscriptBox["B1", "2"], " ", "c2", " ", "v"}], "+", 
        RowBox[{"4", " ", "c1", " ", "c2", " ", "t", " ", "v"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["B2", "2"], " ", "c1"}], "+", 
        RowBox[{
         SuperscriptBox["B1", "2"], " ", "c2"}], "-", 
        RowBox[{"4", " ", "c1", " ", "c2", " ", "t"}]}]]}]}], ",", 
    RowBox[{"s1", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "B1"}], " ", 
         SuperscriptBox["B2", "2"]}], "+", 
        RowBox[{"B1", " ", "c2", " ", "k"}], "+", 
        RowBox[{"2", " ", "B1", " ", "c2", " ", "t"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["B2", "2"], " ", "c1"}], "+", 
        RowBox[{
         SuperscriptBox["B1", "2"], " ", "c2"}], "-", 
        RowBox[{"4", " ", "c1", " ", "c2", " ", "t"}]}]]}]}], ",", 
    RowBox[{"s2", "\[Rule]", 
     FractionBox[
      RowBox[{"B2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         RowBox[{"c1", " ", "k"}], "-", 
         RowBox[{"2", " ", "c1", " ", "t"}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["B2", "2"], " ", "c1"}], "+", 
       RowBox[{
        SuperscriptBox["B1", "2"], " ", "c2"}], "-", 
       RowBox[{"4", " ", "c1", " ", "c2", " ", "t"}]}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8696643275407095`*^9, 3.8696656890691333`*^9, 
  3.869763725363578*^9, 3.869763786948697*^9, 3.869763901578745*^9, 
  3.873677014475707*^9, 3.873677071567312*^9, 3.8736773092428584`*^9, 
  3.873922648010298*^9, 3.8739247801638746`*^9, 3.873924897132349*^9, 
  3.873924991494689*^9, 3.873925085591449*^9, 3.873925924597663*^9, 
  3.873925996438487*^9, 3.873928333736892*^9, 3.88300399970224*^9, 
  3.8830040861073036`*^9, 3.8830041562004623`*^9, 3.8830049504243073`*^9, 
  3.883097444376753*^9, 3.8904337710973606`*^9, 3.8904374402006016`*^9, 
  3.8907851417204866`*^9, 3.90841103171859*^9, 3.9085824111779575`*^9, 
  3.908583061146838*^9, 3.9085832730471354`*^9, 3.9085835731385374`*^9},
 CellLabel->
  "Out[141]=",ExpressionUUID->"6745bc8b-f6b3-43c0-9d1d-de3df2532390"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "expression", " ", "for", " ", "optimal", " ", "price", " ", "p1", " ", 
   "and", " ", "p2"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8830042434923487`*^9, 
  3.883004253841714*^9}},ExpressionUUID->"d008a929-3161-49b7-929b-\
f3cb6f0c8030"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p1", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"p1", "/.", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.88300409693933*^9, 3.883004109517455*^9}, {
  3.883004177508803*^9, 3.8830041862577343`*^9}, {3.890433779382247*^9, 
  3.8904337870310364`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"b9a6ca51-d5d7-4f71-9535-b7d86d630756"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["B1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["B2", "2"], "+", 
      RowBox[{"c2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "k"}], "-", 
         RowBox[{"2", " ", "t"}], "+", "v"}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{"c1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c2", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{"k", "+", 
         RowBox[{"2", " ", "t"}], "-", 
         RowBox[{"4", " ", "v"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["B2", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "t"}], "+", "v"}], ")"}]}]}], ")"}]}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["B2", "2"], " ", "c1"}], "+", 
   RowBox[{"c2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["B1", "2"], "-", 
      RowBox[{"4", " ", "c1", " ", "t"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.883004111912456*^9, 3.8830042176388254`*^9, 3.883004952543344*^9, 
   3.8830974477500954`*^9, {3.8904337808270693`*^9, 3.890433794113062*^9}, 
   3.8904374425636115`*^9, 3.890785143541712*^9, 3.9084110337549915`*^9, 
   3.908582414315998*^9, 3.908583063151915*^9, 3.9085832762717314`*^9, 
   3.9085835748737364`*^9},
 CellLabel->
  "Out[142]=",ExpressionUUID->"a3d05e09-7aa4-462a-b977-db7c91dc4cdc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "expression", " ", "for", " ", "optimal", " ", "CSR", " ", "investment", 
   " ", "s1", " ", "and", " ", "s2"}], "*)"}]], "Input",
 CellChangeTimes->{{3.88300426133843*^9, 
  3.8830042737866025`*^9}},ExpressionUUID->"a2552c17-3a0f-45f0-84ff-\
f593898cd42a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"s1", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"s1", "/.", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"s2", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"s2", "/.", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.88300411661967*^9, 3.883004117609563*^9}, {
  3.8830041907182293`*^9, 3.883004213007213*^9}, {3.8904337889946966`*^9, 
  3.890433791931538*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"08d97b93-0ba5-41e1-97e1-255ad9feee01"],

Cell[BoxData[
 FractionBox[
  RowBox[{"B1", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["B2", "2"], "-", 
     RowBox[{"c2", " ", 
      RowBox[{"(", 
       RowBox[{"k", "+", 
        RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["B2", "2"], " ", "c1"}], "+", 
   RowBox[{"c2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["B1", "2"], "-", 
      RowBox[{"4", " ", "c1", " ", "t"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.8830042206561885`*^9, 3.8830049541938057`*^9, 3.8830974501279564`*^9, {
   3.8904337836825457`*^9, 3.8904337960116806`*^9}, 3.8904374441166925`*^9, 
   3.8907851452946267`*^9, 3.9084110359800444`*^9, 3.908582416189762*^9, 
   3.9085830650986137`*^9, 3.9085832784153805`*^9, 3.9085835769733863`*^9},
 CellLabel->
  "Out[143]=",ExpressionUUID->"1dced842-0bea-43a4-969b-925f2139ab4a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"B2", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["B1", "2"], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{"k", "-", 
        RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["B2", "2"], " ", "c1"}], "+", 
   RowBox[{"c2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["B1", "2"], "-", 
      RowBox[{"4", " ", "c1", " ", "t"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.8830042206561885`*^9, 3.8830049541938057`*^9, 3.8830974501279564`*^9, {
   3.8904337836825457`*^9, 3.8904337960116806`*^9}, 3.8904374441166925`*^9, 
   3.8907851452946267`*^9, 3.9084110359800444`*^9, 3.908582416189762*^9, 
   3.9085830650986137`*^9, 3.9085832784153805`*^9, 3.9085835769753995`*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"1903115d-840b-48ee-b788-d8d1ccf569ce"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"non", "-", 
   RowBox[{
   "green", " ", "and", " ", "green", " ", "market", " ", "share", " ", 
    "under", " ", "the", " ", "optimal", " ", "prices", " ", "and", " ", 
    "CSR", " ", "investment"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.883004279566414*^9, 3.8830043088108497`*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"cec73689-77d4-4e48-840b-019c646edfe7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"x", "/.", 
   RowBox[{"sol", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"1", " ", "-", " ", "x"}], "/.", 
   RowBox[{"sol", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.873677079999561*^9, 3.8736772663353844`*^9}, {
  3.883004226666083*^9, 3.8830042275348654`*^9}, {3.8830043148292294`*^9, 
  3.883004337921043*^9}, {3.908410944759572*^9, 3.908410947479948*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"33d58f7f-305a-4d97-95a8-b08f03b5f40b"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c1", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["B2", "2"], "-", 
     RowBox[{"c2", " ", 
      RowBox[{"(", 
       RowBox[{"k", "+", 
        RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["B2", "2"], " ", "c1"}], "+", 
   RowBox[{"c2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["B1", "2"], "-", 
      RowBox[{"4", " ", "c1", " ", "t"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.873677094753072*^9, 3.873677106991234*^9}, {
   3.8736771491287823`*^9, 3.8736771836921453`*^9}, {3.8736772214633055`*^9, 
   3.873677238033496*^9}, 3.873677268625588*^9, 3.873677312577612*^9, 
   3.8739226511412764`*^9, 3.873924783903401*^9, 3.873924901187361*^9, 
   3.873924994387364*^9, 3.8739250875743675`*^9, 3.873925928777547*^9, 
   3.8739260029361887`*^9, 3.873926528686367*^9, 3.8739283364845467`*^9, 
   3.8830040063783607`*^9, {3.883004323210495*^9, 3.883004339392295*^9}, 
   3.8830049571565175`*^9, 3.883097454168835*^9, 3.8904337992086687`*^9, 
   3.890437445697276*^9, 3.890785147371546*^9, 3.908411038173098*^9, 
   3.908582418714653*^9, 3.908583067879265*^9, 3.9085832814521666`*^9, 
   3.908583578785951*^9},
 CellLabel->
  "Out[145]=",ExpressionUUID->"6eee4974-f72f-4fec-b598-5b4443b33b5a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c2", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["B1", "2"], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{"k", "-", 
        RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["B2", "2"], " ", "c1"}], "+", 
   RowBox[{"c2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["B1", "2"], "-", 
      RowBox[{"4", " ", "c1", " ", "t"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.873677094753072*^9, 3.873677106991234*^9}, {
   3.8736771491287823`*^9, 3.8736771836921453`*^9}, {3.8736772214633055`*^9, 
   3.873677238033496*^9}, 3.873677268625588*^9, 3.873677312577612*^9, 
   3.8739226511412764`*^9, 3.873924783903401*^9, 3.873924901187361*^9, 
   3.873924994387364*^9, 3.8739250875743675`*^9, 3.873925928777547*^9, 
   3.8739260029361887`*^9, 3.873926528686367*^9, 3.8739283364845467`*^9, 
   3.8830040063783607`*^9, {3.883004323210495*^9, 3.883004339392295*^9}, 
   3.8830049571565175`*^9, 3.883097454168835*^9, 3.8904337992086687`*^9, 
   3.890437445697276*^9, 3.890785147371546*^9, 3.908411038173098*^9, 
   3.908582418714653*^9, 3.908583067879265*^9, 3.9085832814521666`*^9, 
   3.908583578797778*^9},
 CellLabel->
  "Out[146]=",ExpressionUUID->"a0d10522-fd02-4d9b-8271-0af3ea0f9c19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"c1", " ", "=", " ", "c"}], "\[IndentingNewLine]", 
 RowBox[{"c2", " ", "=", " ", "c"}]}], "Input",
 CellChangeTimes->{{3.9085824441411886`*^9, 3.908582447386814*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"2c5fc671-11f7-448f-8ef7-3496e27b377e"],

Cell[BoxData["c"], "Output",
 CellChangeTimes->{3.9085824484960527`*^9, 3.9085830701494217`*^9, 
  3.908583288708699*^9, 3.908583580836583*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"a7c04767-5fb8-4ff8-a73e-deb22ee7e708"],

Cell[BoxData["c"], "Output",
 CellChangeTimes->{3.9085824484960527`*^9, 3.9085830701494217`*^9, 
  3.908583288708699*^9, 3.9085835808432245`*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"204c01d1-49aa-4130-abc6-6aaee92a477c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"R", " ", "-", " ", "v", "  ", "+", " ", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.8904338089132853`*^9, 3.8904338107288084`*^9}, {
  3.90858242360039*^9, 3.908582427598057*^9}, {3.9085824866847773`*^9, 
  3.908582497079567*^9}, {3.9085826328173423`*^9, 3.90858266058216*^9}, {
  3.908583075514281*^9, 3.90858308053833*^9}, {3.908583584880107*^9, 
  3.908583585657872*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"4911431d-eb14-4e35-b45e-29fb28a8bf54"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["B1", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"2", " ", "c", " ", "k"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"k", "-", 
        RowBox[{"2", " ", "t"}]}], ")"}], "2"]}]}], 
   RowBox[{"2", " ", "c", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["B1", "2"], "+", 
      SuperscriptBox["B2", "2"], "-", 
      RowBox[{"4", " ", "c", " ", "t"}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.8904338120873733`*^9, 3.8904374473115487`*^9, 3.890785149124699*^9, 
   3.908411040698318*^9, {3.9085824210850077`*^9, 3.908582451519829*^9}, {
   3.908582488453388*^9, 3.9085824978510447`*^9}, {3.908582656645627*^9, 
   3.908582661425994*^9}, {3.908583076764612*^9, 3.9085830814618073`*^9}, 
   3.9085832911076756`*^9, {3.9085835826932516`*^9, 3.9085835868566184`*^9}},
 CellLabel->
  "Out[150]=",ExpressionUUID->"176279f3-1136-4633-9ddf-42c6d0858f23"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Tipping", " ", "point", " ", "for", " ", "cooperative", " ", "markets"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.8908645611345606`*^9, 
  3.8908645743807507`*^9}},ExpressionUUID->"c6ce5d53-fc90-4d0d-b531-\
aa7130f86305"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellLabel->
  "In[151]:=",ExpressionUUID->"545ed305-fa06-4a0d-801d-b53a5ada9a11"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"c1", " ", "=", " ", "c"}], "\[IndentingNewLine]", 
 RowBox[{"c2", " ", "=", " ", "c"}]}], "Input",
 CellChangeTimes->{{3.8909228939320197`*^9, 3.890922896477284*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"d21b7677-472a-4c84-8ed5-8c57a3158de3"],

Cell[BoxData["c"], "Output",
 CellChangeTimes->{3.8909228974754725`*^9, 3.8918975435356503`*^9, 
  3.892682123900057*^9, 3.9085839387431536`*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"40ea9714-330c-4285-8e2b-d26154fb9783"],

Cell[BoxData["c"], "Output",
 CellChangeTimes->{3.8909228974754725`*^9, 3.8918975435356503`*^9, 
  3.892682123900057*^9, 3.9085839387516184`*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"b5a7e7f8-3a2e-4efa-b128-d4352b4b8290"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["B1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["B2", "2"], "-", 
        RowBox[{"c2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "k"}], "+", "t", "-", 
           RowBox[{"2", " ", "v"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["B2", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", 
           RowBox[{"2", " ", "v"}]}], ")"}]}], "+", 
        RowBox[{"c2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["k", "2"]}], "+", 
           RowBox[{"2", " ", "k", " ", "t"}], "+", 
           SuperscriptBox["t", "2"], "-", 
           RowBox[{"4", " ", "t", " ", "v"}]}], ")"}]}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["B2", "2"], " ", "c1"}], "+", 
       RowBox[{"c2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["B1", "2"], "-", 
          RowBox[{"2", " ", "c1", " ", "t"}]}], ")"}]}]}], ")"}]}]], " ", "-",
    " ", "v", " ", "+", " ", 
   RowBox[{"t", "/", "2"}]}], "]"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"d39275c1-484c-4c90-bdca-7ac7ffcaf670"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["B1", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"2", " ", "c", " ", "k"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"k", "-", "t"}], ")"}], "2"]}]}], 
   RowBox[{"2", " ", "c", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["B1", "2"], "+", 
      SuperscriptBox["B2", "2"], "-", 
      RowBox[{"2", " ", "c", " ", "t"}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.8918975459260635`*^9, 3.8926821266463165`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"006fa944-a556-46fa-a32e-71da8c9f1acd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["B1", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["B2", "2"], "-", 
          RowBox[{"2", " ", "c", " ", "k"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"k", "-", 
           RowBox[{"2", " ", "t"}]}], ")"}], "2"]}]}], 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         SuperscriptBox["B2", "2"], "-", 
         RowBox[{"4", " ", "c", " ", "t"}]}], ")"}]}]]}], "==", 
    RowBox[{
     FractionBox[
      SuperscriptBox["B2", "2"], 
      RowBox[{"4", " ", "c2"}]], "-", "k", "-", 
     FractionBox["t", "2"], "+", "v", "-", "v", "+", "t"}]}], ",", 
   RowBox[{"{", "k", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8926819972668386`*^9, {3.9085838870066233`*^9, 3.9085839290929813`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"1fef2f0a-2b2c-4438-ab25-625b9872f68d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"k", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["B1", "2"], "+", 
          SuperscriptBox["B2", "2"], "-", 
          RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          FractionBox[
           SuperscriptBox["B1", "2"], 
           RowBox[{
            SuperscriptBox["B1", "2"], "+", 
            SuperscriptBox["B2", "2"], "-", 
            RowBox[{"4", " ", "c", " ", "t"}]}]], "-", 
          FractionBox[
           RowBox[{"2", " ", "c", " ", "t"}], 
           RowBox[{
            SuperscriptBox["B1", "2"], "+", 
            SuperscriptBox["B2", "2"], "-", 
            RowBox[{"4", " ", "c", " ", "t"}]}]], "-", 
          SqrtBox[
           RowBox[{"1", "+", 
            FractionBox[
             SuperscriptBox["B1", "4"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "+", 
            FractionBox[
             RowBox[{
              SuperscriptBox["B1", "2"], " ", 
              SuperscriptBox["B2", "2"]}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
            FractionBox[
             RowBox[{"4", " ", 
              SuperscriptBox["B1", "2"], " ", "c", " ", "t"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox["B1", "2"]}], 
             RowBox[{
              SuperscriptBox["B1", "2"], "+", 
              SuperscriptBox["B2", "2"], "-", 
              RowBox[{"4", " ", "c", " ", "t"}]}]], "-", 
            FractionBox[
             SuperscriptBox["B2", "2"], 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}]}]], "+", 
            FractionBox[
             RowBox[{"3", " ", "c", " ", "t"}], 
             RowBox[{
              SuperscriptBox["B1", "2"], "+", 
              SuperscriptBox["B2", "2"], "-", 
              RowBox[{"4", " ", "c", " ", "t"}]}]]}]]}], ")"}]}], "c"]}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["B1", "2"], "+", 
          SuperscriptBox["B2", "2"], "-", 
          RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          FractionBox[
           SuperscriptBox["B1", "2"], 
           RowBox[{
            SuperscriptBox["B1", "2"], "+", 
            SuperscriptBox["B2", "2"], "-", 
            RowBox[{"4", " ", "c", " ", "t"}]}]], "-", 
          FractionBox[
           RowBox[{"2", " ", "c", " ", "t"}], 
           RowBox[{
            SuperscriptBox["B1", "2"], "+", 
            SuperscriptBox["B2", "2"], "-", 
            RowBox[{"4", " ", "c", " ", "t"}]}]], "+", 
          SqrtBox[
           RowBox[{"1", "+", 
            FractionBox[
             SuperscriptBox["B1", "4"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "+", 
            FractionBox[
             RowBox[{
              SuperscriptBox["B1", "2"], " ", 
              SuperscriptBox["B2", "2"]}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
            FractionBox[
             RowBox[{"4", " ", 
              SuperscriptBox["B1", "2"], " ", "c", " ", "t"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox["B1", "2"]}], 
             RowBox[{
              SuperscriptBox["B1", "2"], "+", 
              SuperscriptBox["B2", "2"], "-", 
              RowBox[{"4", " ", "c", " ", "t"}]}]], "-", 
            FractionBox[
             SuperscriptBox["B2", "2"], 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}]}]], "+", 
            FractionBox[
             RowBox[{"3", " ", "c", " ", "t"}], 
             RowBox[{
              SuperscriptBox["B1", "2"], "+", 
              SuperscriptBox["B2", "2"], "-", 
              RowBox[{"4", " ", "c", " ", "t"}]}]]}]]}], ")"}]}], "c"]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8918975687443886`*^9, 3.892681999598387*^9, 
  3.8926821297410803`*^9, 3.908583941636959*^9},
 CellLabel->
  "Out[154]=",ExpressionUUID->"20976f6d-6b9f-403e-8fb9-9c567d705e95"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["B1", "2"], "+", 
     SuperscriptBox["B2", "2"], "-", 
     RowBox[{"4", "c", " ", "t"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox[
      SuperscriptBox["B1", "2"], 
      RowBox[{
       SuperscriptBox["B1", "2"], "+", 
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"4", " ", "c", " ", "t"}]}]], "-", 
     FractionBox[
      RowBox[{"2", "c", " ", "t"}], 
      RowBox[{
       SuperscriptBox["B1", "2"], "+", 
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"4", "c", " ", "t"}]}]]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892682009658365*^9, 3.892682026628537*^9}, {
  3.8926821516271644`*^9, 3.892682161412678*^9}, {3.908583954910655*^9, 
  3.9085839674059515`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"de0998bb-0110-4aaa-b6d2-6904f0aecb65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["B2", "2"]}], "+", 
  RowBox[{"2", " ", "c", " ", "t"}]}]], "Output",
 CellChangeTimes->{3.8926821639469924`*^9, 3.9085839749099283`*^9},
 CellLabel->
  "Out[155]=",ExpressionUUID->"267de128-c02d-4051-b58e-64f52bbc649d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["B1", "4"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         SuperscriptBox["B2", "2"], "-", 
         RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["B1", "2"], " ", 
       SuperscriptBox["B2", "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         SuperscriptBox["B2", "2"], "-", 
         RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox["B1", "2"], " ", "c", " ", "t"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         SuperscriptBox["B2", "2"], "-", 
         RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["B1", "2"]}], 
      RowBox[{
       SuperscriptBox["B1", "2"], "+", 
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"4", " ", "c", " ", "t"}]}]], "-", 
     FractionBox[
      SuperscriptBox["B2", "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         SuperscriptBox["B2", "2"], "-", 
         RowBox[{"4", " ", "c", " ", "t"}]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"3", " ", "c", " ", "t"}], 
      RowBox[{
       SuperscriptBox["B1", "2"], "+", 
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"4", " ", "c", " ", "t"}]}]]}], ")"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["B1", "2"], "+", 
      SuperscriptBox["B2", "2"], "-", 
      RowBox[{"4", "c", " ", "t"}]}], ")"}], " ", "^", "2"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.892682054261051*^9, 3.892682106046563*^9}, 
   3.8926821808156652`*^9, {3.908583983106094*^9, 3.908584031561414*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"2804e1a4-bf9c-408c-98b2-c8e7f9ea7ee8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["B1", "2"], "+", 
    SuperscriptBox["B2", "2"], "-", 
    RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["B2", "2"], "-", 
    RowBox[{"2", " ", "c", " ", "t"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.892682107661873*^9, 3.8926821833925414`*^9, 
  3.9085840451262445`*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"f717b6ff-66ee-4b34-84ae-a36c7f5cf949"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["B1", "2"], "+", 
     SuperscriptBox["B2", "2"], "-", 
     RowBox[{"2", " ", "c", " ", "t"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     FractionBox[
      SuperscriptBox["B1", "2"], 
      RowBox[{
       SuperscriptBox["B1", "2"], "+", 
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"2", " ", "c", " ", "t"}]}]], "+", 
     FractionBox[
      RowBox[{"c", " ", "t"}], 
      RowBox[{
       SuperscriptBox["B1", "2"], "+", 
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"2", " ", "c", " ", "t"}]}]]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891943284508279*^9, 3.8919432950025196`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"0323118f-a0f9-4030-a9c6-ded35278d104"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   SuperscriptBox["B1", "2"]}], "-", 
  SuperscriptBox["B2", "2"], "+", 
  RowBox[{"3", " ", "c", " ", "t"}]}]], "Output",
 CellChangeTimes->{3.8919432986463237`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"628783a8-c425-4bc8-98ef-021f48295dd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["B1", "2"], "+", 
     SuperscriptBox["B2", "2"], "-", 
     RowBox[{"2", " ", "c", " ", "t"}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["B1", "4"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         SuperscriptBox["B2", "2"], "-", 
         RowBox[{"2", " ", "c", " ", "t"}]}], ")"}], "2"]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["B1", "2"], " ", 
       SuperscriptBox["B2", "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         SuperscriptBox["B2", "2"], "-", 
         RowBox[{"2", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["B1", "2"], " ", "c", " ", "t"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         SuperscriptBox["B2", "2"], "-", 
         RowBox[{"2", " ", "c", " ", "t"}]}], ")"}], "2"]], "+", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["B1", "2"]}], 
      RowBox[{
       SuperscriptBox["B1", "2"], "+", 
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"2", " ", "c", " ", "t"}]}]], "+", 
     FractionBox[
      SuperscriptBox["B2", "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         SuperscriptBox["B2", "2"], "-", 
         RowBox[{"2", " ", "c", " ", "t"}]}], ")"}]}]], "-", 
     FractionBox[
      RowBox[{"3", " ", "c", " ", "t"}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         SuperscriptBox["B2", "2"], "-", 
         RowBox[{"2", " ", "c", " ", "t"}]}], ")"}]}]]}], ")"}]}], " ", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8919433029190283`*^9, 3.8919433281006193`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"2b00c567-473e-4751-85b3-cd419ab5c2b4"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"8", " ", 
     SuperscriptBox["B1", "2"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["B2", "2"]}], "-", 
    RowBox[{"7", " ", "c", " ", "t"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.8919433311219406`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"ff9ba4fe-32f6-4c30-aa99-0a6ee689213e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["B1", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["B2", "2"], "-", 
          RowBox[{"2", " ", "c", " ", "k"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"k", "-", 
           RowBox[{"2", " ", "t"}]}], ")"}], "2"]}]}], 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["B1", "2"], "+", 
         SuperscriptBox["B2", "2"], "-", 
         RowBox[{"4", " ", "c", " ", "t"}]}], ")"}]}]]}], "==", 
    RowBox[{
     FractionBox[
      SuperscriptBox["B1", "2"], 
      RowBox[{"4", " ", "c1"}]], "-", 
     FractionBox["t", "2"], "+", "v", "-", "v", "+", "t"}]}], ",", 
   RowBox[{"{", "k", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.891907131112915*^9, {3.908584362172917*^9, 3.9085843655514765`*^9}, {
   3.908584402853566*^9, 3.908584419929441*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"2641c153-b436-490f-aa3a-d408ffb59c8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"k", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["B1", "2"], "+", 
          SuperscriptBox["B2", "2"], "-", 
          RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SuperscriptBox["B1", "2"], 
           RowBox[{
            SuperscriptBox["B1", "2"], "+", 
            SuperscriptBox["B2", "2"], "-", 
            RowBox[{"4", " ", "c", " ", "t"}]}]], "-", 
          FractionBox[
           RowBox[{"2", " ", "c", " ", "t"}], 
           RowBox[{
            SuperscriptBox["B1", "2"], "+", 
            SuperscriptBox["B2", "2"], "-", 
            RowBox[{"4", " ", "c", " ", "t"}]}]], "-", 
          SqrtBox[
           RowBox[{
            FractionBox[
             SuperscriptBox["B1", "4"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "+", 
            FractionBox[
             RowBox[{
              SuperscriptBox["B1", "2"], " ", 
              SuperscriptBox["B2", "2"]}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
            FractionBox[
             RowBox[{"4", " ", 
              SuperscriptBox["B1", "2"], " ", "c", " ", "t"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
            FractionBox[
             SuperscriptBox["B1", "2"], 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}]}]], "-", 
            FractionBox[
             RowBox[{"c", " ", "t"}], 
             RowBox[{
              SuperscriptBox["B1", "2"], "+", 
              SuperscriptBox["B2", "2"], "-", 
              RowBox[{"4", " ", "c", " ", "t"}]}]]}]]}], ")"}]}], "c"]}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["B1", "2"], "+", 
          SuperscriptBox["B2", "2"], "-", 
          RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SuperscriptBox["B1", "2"], 
           RowBox[{
            SuperscriptBox["B1", "2"], "+", 
            SuperscriptBox["B2", "2"], "-", 
            RowBox[{"4", " ", "c", " ", "t"}]}]], "-", 
          FractionBox[
           RowBox[{"2", " ", "c", " ", "t"}], 
           RowBox[{
            SuperscriptBox["B1", "2"], "+", 
            SuperscriptBox["B2", "2"], "-", 
            RowBox[{"4", " ", "c", " ", "t"}]}]], "+", 
          SqrtBox[
           RowBox[{
            FractionBox[
             SuperscriptBox["B1", "4"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "+", 
            FractionBox[
             RowBox[{
              SuperscriptBox["B1", "2"], " ", 
              SuperscriptBox["B2", "2"]}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
            FractionBox[
             RowBox[{"4", " ", 
              SuperscriptBox["B1", "2"], " ", "c", " ", "t"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
            FractionBox[
             SuperscriptBox["B1", "2"], 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["B1", "2"], "+", 
                SuperscriptBox["B2", "2"], "-", 
                RowBox[{"4", " ", "c", " ", "t"}]}], ")"}]}]], "-", 
            FractionBox[
             RowBox[{"c", " ", "t"}], 
             RowBox[{
              SuperscriptBox["B1", "2"], "+", 
              SuperscriptBox["B2", "2"], "-", 
              RowBox[{"4", " ", "c", " ", "t"}]}]]}]]}], ")"}]}], "c"]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8919071405534086`*^9, 3.9085844233313804`*^9},
 CellLabel->
  "Out[159]=",ExpressionUUID->"4ff076fc-c7fd-4e6f-bb15-92d15ab86eb8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["B1", "2"], "+", 
     SuperscriptBox["B2", "2"], "-", 
     RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "  ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["B1", "2"], 
      RowBox[{
       SuperscriptBox["B1", "2"], "+", 
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"4", " ", "c", " ", "t"}]}]], "-", 
     FractionBox[
      RowBox[{"2", " ", "c", " ", "t"}], 
      RowBox[{
       SuperscriptBox["B1", "2"], "+", 
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"4", " ", "c", " ", "t"}]}]]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8919434170043545`*^9, 3.891943425865551*^9}, {
  3.90858443603588*^9, 3.908584446389825*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"ec763910-ca95-4360-9ffb-d22670b60c4f"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["B1", "2"], "-", 
  RowBox[{"2", " ", "c", " ", "t"}]}]], "Output",
 CellChangeTimes->{3.89194342733615*^9, 3.9085844517790985`*^9, 
  3.908584574091988*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"e5df8c39-af54-4625-b5c8-073478f6f841"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["B1", "2"], "+", 
       SuperscriptBox["B2", "2"], "-", 
       RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], " ", "^", "2"}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SuperscriptBox["B1", "4"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["B1", "2"], "+", 
          SuperscriptBox["B2", "2"], "-", 
          RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["B1", "2"], " ", 
        SuperscriptBox["B2", "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["B1", "2"], "+", 
          SuperscriptBox["B2", "2"], "-", 
          RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox["B1", "2"], " ", "c", " ", "t"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["B1", "2"], "+", 
          SuperscriptBox["B2", "2"], "-", 
          RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], "2"]], "-", 
      FractionBox[
       SuperscriptBox["B1", "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["B1", "2"], "+", 
          SuperscriptBox["B2", "2"], "-", 
          RowBox[{"4", " ", "c", " ", "t"}]}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"c", " ", "t"}], 
       RowBox[{
        SuperscriptBox["B1", "2"], "+", 
        SuperscriptBox["B2", "2"], "-", 
        RowBox[{"4", " ", "c", " ", "t"}]}]]}], ")"}]}], ")"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.891943428810192*^9, 3.891943447444108*^9}, {
  3.908584484690629*^9, 3.9085845032291107`*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"5b72e12e-9226-4032-a6a7-2e78a8345ecd"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["B1", "2"], "+", 
    SuperscriptBox["B2", "2"], "-", 
    RowBox[{"4", " ", "c", " ", "t"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["B1", "2"], "-", 
    RowBox[{"2", " ", "c", " ", "t"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.891943450022813*^9, 3.908584576684037*^9},
 CellLabel->
  "Out[164]=",ExpressionUUID->"1741ec54-ad7e-450a-9db1-2b1cf8eedba7"]
}, Open  ]]
},
WindowSize->{949, 461},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.7 Inherited,
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8691bcad-b88e-4229-8429-2d4e1f0badbf"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 216, 5, 21, "Input",ExpressionUUID->"3b4f6fe1-c147-44e7-8623-bc7d363681a7"],
Cell[777, 27, 624, 9, 21, "Input",ExpressionUUID->"ab6dbfaf-8785-41ab-9cd1-36310adeb4d0"],
Cell[1404, 38, 124, 2, 21, "Input",ExpressionUUID->"a35c5a9d-f4ea-412f-8b2a-5caa04b0e815"],
Cell[CellGroupData[{
Cell[1553, 44, 269, 4, 34, "Input",ExpressionUUID->"096ddc44-6575-4d55-928a-db3ac3b2437a"],
Cell[1825, 50, 273, 4, 23, "Output",ExpressionUUID->"10597fba-f956-4ff3-b206-91d001fbf802"],
Cell[2101, 56, 274, 4, 23, "Output",ExpressionUUID->"47214e54-ed07-4145-bfd7-b1a300aec0e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2412, 65, 1195, 21, 34, "Input",ExpressionUUID->"0a6f1011-e281-4793-9522-7dd973e105c2"],
Cell[3610, 88, 353, 7, 23, "Output",ExpressionUUID->"80890e61-0d98-48fc-9761-33ed8fac71c2"],
Cell[3966, 97, 402, 9, 23, "Output",ExpressionUUID->"527ce70e-db42-4bc1-b911-cce2777b5c01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4405, 111, 973, 20, 34, "Input",ExpressionUUID->"cd31be75-b789-46c6-8ff8-f3259ef2005d"],
Cell[5381, 133, 1487, 29, 36, "Output",ExpressionUUID->"1f874be5-92d9-4b10-96eb-0fe7ccad07d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6905, 167, 1077, 24, 47, "Input",ExpressionUUID->"1f2e9830-d623-4950-a117-58e34d7c6439"],
Cell[7985, 193, 1138, 19, 36, "Output",ExpressionUUID->"fde01372-1ec7-49ce-8b9e-f32f020872ae"],
Cell[9126, 214, 1181, 20, 23, "Output",ExpressionUUID->"bf68e676-0232-476d-838b-9ac89f1ac7a4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10344, 239, 1422, 33, 34, "Input",ExpressionUUID->"ff4334b3-3771-405b-987b-8f5552e0f5b6"],
Cell[11769, 274, 1072, 33, 37, "Output",ExpressionUUID->"12bf8415-992c-4c34-b3ba-167fded5cb11"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12878, 312, 301, 4, 21, "Input",ExpressionUUID->"b3a33d57-9ee6-4587-8baf-f5a86fd40b71"],
Cell[13182, 318, 1071, 33, 37, "Output",ExpressionUUID->"2af7d1b5-3b87-4374-81e2-58fd27998438"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14290, 356, 1266, 29, 34, "Input",ExpressionUUID->"4d4fcd40-4744-4e4a-81ec-5086e6bd88fa"],
Cell[15559, 387, 1362, 30, 39, "Output",ExpressionUUID->"a49cfae6-3ed2-4e0f-9356-aa4735c036bc"]
}, Open  ]],
Cell[16936, 420, 284, 7, 21, "Input",ExpressionUUID->"6904230a-cd3c-4c69-af29-baa3e423ff92"],
Cell[CellGroupData[{
Cell[17245, 431, 470, 9, 21, "Input",ExpressionUUID->"53d84b96-a585-4c7c-ba38-fb20c3e8d0e2"],
Cell[17718, 442, 593, 12, 39, "Output",ExpressionUUID->"df426835-9043-425d-89c6-886bc3faf648"]
}, Open  ]],
Cell[18326, 457, 300, 7, 21, "Input",ExpressionUUID->"18338a1f-e956-4c8b-815d-a792cfa7c07e"],
Cell[CellGroupData[{
Cell[18651, 468, 607, 14, 34, "Input",ExpressionUUID->"2c46ca33-7d17-4b11-8e68-7ca355ceb04e"],
Cell[19261, 484, 462, 8, 36, "Output",ExpressionUUID->"1e16aaa5-a14d-44f0-add7-292e6f504109"],
Cell[19726, 494, 464, 8, 36, "Output",ExpressionUUID->"a60291ed-b50e-4a55-b11b-1eb8c187a7ce"]
}, Open  ]],
Cell[20205, 505, 414, 9, 21, "Input",ExpressionUUID->"2695a0b7-ba74-4663-831b-aa92c5ae972e"],
Cell[CellGroupData[{
Cell[20644, 518, 616, 13, 34, "Input",ExpressionUUID->"febd9de4-1bdb-4f90-8963-f735a9922e2a"],
Cell[21263, 533, 887, 13, 36, "Output",ExpressionUUID->"ac76263d-ab86-4f33-8580-014dc2f35b23"],
Cell[22153, 548, 887, 13, 36, "Output",ExpressionUUID->"17c7db71-78bc-4c86-b51b-7d5cff97f3c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23077, 566, 255, 4, 21, "Input",ExpressionUUID->"1b773877-4118-41db-a5cc-f3ac1f36c1e8"],
Cell[23335, 572, 333, 8, 39, "Output",ExpressionUUID->"ce849770-9323-4b29-a0d6-32f949ba4a9f"]
}, Open  ]],
Cell[23683, 583, 154, 3, 21, "Input",ExpressionUUID->"3740c19c-3741-47d7-9945-de2ccc19c2a7"],
Cell[23840, 588, 152, 2, 21, "Input",ExpressionUUID->"6578ae90-4791-492f-a1c1-6252b151ffa1"],
Cell[CellGroupData[{
Cell[24017, 594, 496, 10, 47, "Input",ExpressionUUID->"e6b2bf1a-1fd3-4f0f-925f-49c238940984"],
Cell[24516, 606, 223, 3, 23, "Output",ExpressionUUID->"e414bcb1-b71c-4964-9fbd-d6cd32f6bdd5"],
Cell[24742, 611, 223, 3, 23, "Output",ExpressionUUID->"43da876c-ed29-4929-9692-58d0628d67d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25002, 619, 1194, 21, 34, "Input",ExpressionUUID->"8adf2bf0-d009-41fb-bbb7-0c9544918ce8"],
Cell[26199, 642, 380, 8, 23, "Output",ExpressionUUID->"c3e9a93b-5f40-482b-8b5c-311d2a1922b9"],
Cell[26582, 652, 429, 10, 23, "Output",ExpressionUUID->"80bd4b02-2700-4f91-a0c5-89269e7967bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27048, 667, 973, 20, 34, "Input",ExpressionUUID->"85eeabd9-dce6-4f45-a81c-869ff588d6c9"],
Cell[28024, 689, 1515, 30, 36, "Output",ExpressionUUID->"6ca02f58-29c5-409f-8495-eb79fdedd0d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29576, 724, 1077, 24, 47, "Input",ExpressionUUID->"f4b173c8-e1fb-497a-a02f-88aca14539dd"],
Cell[30656, 750, 1160, 19, 36, "Output",ExpressionUUID->"2481c2ec-ac66-48ff-aec4-8a43b3bd798d"],
Cell[31819, 771, 1204, 20, 23, "Output",ExpressionUUID->"8288d6a2-3c2d-4849-8d50-c9d76349bf8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33060, 796, 1417, 31, 34, "Input",ExpressionUUID->"2021d52f-e39c-4e9b-ac99-9d4c36f66167"],
Cell[34480, 829, 1015, 31, 36, "Output",ExpressionUUID->"ad877eb2-ea0a-4a5c-83dd-956a65c1fd19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35532, 865, 301, 4, 21, "Input",ExpressionUUID->"eecee717-16f6-4beb-b93b-88da2b071107"],
Cell[35836, 871, 1013, 31, 36, "Output",ExpressionUUID->"b2123523-adbf-4f84-94b5-6a226dd6cf65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36886, 907, 1266, 29, 34, "Input",ExpressionUUID->"e1d2f6e8-e580-4830-8ce7-cec100361ecb"],
Cell[38155, 938, 1394, 31, 39, "Output",ExpressionUUID->"ae528b17-fe54-4c20-b6c3-d1041ae6cba4"]
}, Open  ]],
Cell[39564, 972, 284, 7, 21, "Input",ExpressionUUID->"8ed367be-4c69-4474-a66a-887b9a324df8"],
Cell[CellGroupData[{
Cell[39873, 983, 470, 9, 21, "Input",ExpressionUUID->"e83a079b-c555-4783-907b-d538c525419a"],
Cell[40346, 994, 617, 12, 39, "Output",ExpressionUUID->"ff3862ac-3700-4ca2-9c61-c027edb73204"]
}, Open  ]],
Cell[40978, 1009, 300, 7, 21, "Input",ExpressionUUID->"cfb93d92-b5b5-4abd-9184-215b7f2666e2"],
Cell[CellGroupData[{
Cell[41303, 1020, 607, 14, 34, "Input",ExpressionUUID->"adb38cb1-a5c6-4b5c-9f4d-ca1bc2daa866"],
Cell[41913, 1036, 481, 8, 36, "Output",ExpressionUUID->"ffa0e9e0-fc16-44ee-bbc4-942eb274654b"],
Cell[42397, 1046, 483, 8, 36, "Output",ExpressionUUID->"16261c2b-5956-4fd4-8cf0-1b434dc4134b"]
}, Open  ]],
Cell[42895, 1057, 414, 9, 21, "Input",ExpressionUUID->"8226e997-d64d-4615-9920-717ea9088087"],
Cell[CellGroupData[{
Cell[43334, 1070, 618, 13, 34, "Input",ExpressionUUID->"019b575b-d3b7-402e-a6b5-98392b779508"],
Cell[43955, 1085, 907, 13, 36, "Output",ExpressionUUID->"3b8925b3-405e-4374-8578-d542aa41d0c2"],
Cell[44865, 1100, 904, 13, 36, "Output",ExpressionUUID->"b92b9e59-e235-4bb7-a2df-b89cc977c8e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45806, 1118, 255, 4, 21, "Input",ExpressionUUID->"60107f63-8823-4fd7-af16-e70979515bb0"],
Cell[46064, 1124, 342, 8, 39, "Output",ExpressionUUID->"e1b4804d-6ef9-4267-86ca-527f63b68197"]
}, Open  ]],
Cell[46421, 1135, 152, 3, 21, "Input",ExpressionUUID->"88609aca-a373-4c92-914f-70eda3925393"],
Cell[46576, 1140, 710, 13, 34, "Input",ExpressionUUID->"242f3857-fbea-498e-96aa-4fabaa316fc2"],
Cell[47289, 1155, 180, 4, 21, "Input",ExpressionUUID->"1be1d32e-42fd-476d-abab-97ab14046ba3"],
Cell[CellGroupData[{
Cell[47494, 1163, 1379, 30, 47, "Input",ExpressionUUID->"ae968bed-d977-4aed-aa90-4b912cfab27a"],
Cell[48876, 1195, 430, 9, 33, "Output",ExpressionUUID->"7f6fc716-25f0-40e9-8a03-05b1c5930c5c"],
Cell[49309, 1206, 481, 11, 33, "Output",ExpressionUUID->"fff94c51-f808-4e64-b3e7-ed80208ece2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49827, 1222, 978, 21, 34, "Input",ExpressionUUID->"62ed3067-3889-4dcf-bfce-f6ff2ffa65a0"],
Cell[50808, 1245, 1487, 30, 46, "Output",ExpressionUUID->"f5f3d9ef-9b09-437b-802c-4f0cdb59c73b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52332, 1280, 1080, 25, 47, "Input",ExpressionUUID->"260644d1-2d39-4848-bfad-a67a32e5f7ec"],
Cell[53415, 1307, 1134, 20, 46, "Output",ExpressionUUID->"09355ae0-1064-4249-9f05-9b97d5a7f4e1"],
Cell[54552, 1329, 1178, 21, 33, "Output",ExpressionUUID->"971a7cb8-14c6-4a3b-a37b-89ab744f7c62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55767, 1355, 1325, 31, 34, "Input",ExpressionUUID->"8c24a6cc-1450-4489-932c-054367552ba7"],
Cell[57095, 1388, 1108, 33, 46, "Output",ExpressionUUID->"1ae77f06-4f92-4762-83c3-95bf6097ec98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58240, 1426, 329, 5, 21, "Input",ExpressionUUID->"e504e13a-12d8-4d68-8ae2-871be96020f0"],
Cell[58572, 1433, 1418, 38, 46, "Output",ExpressionUUID->"eb93f7f1-596f-4a29-9227-2fb37a71e720"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60027, 1476, 1274, 30, 34, "Input",ExpressionUUID->"e040cd1a-8d97-49fc-8aba-c1dd158a7e66"],
Cell[61304, 1508, 2944, 73, 51, "Output",ExpressionUUID->"6745bc8b-f6b3-43c0-9d1d-de3df2532390"]
}, Open  ]],
Cell[64263, 1584, 284, 7, 21, "Input",ExpressionUUID->"d008a929-3161-49b7-929b-f3cb6f0c8030"],
Cell[CellGroupData[{
Cell[64572, 1595, 429, 10, 21, "Input",ExpressionUUID->"b9a6ca51-d5d7-4f71-9535-b7d86d630756"],
Cell[65004, 1607, 1374, 41, 55, "Output",ExpressionUUID->"a3d05e09-7aa4-462a-b977-db7c91dc4cdc"]
}, Open  ]],
Cell[66393, 1651, 300, 7, 21, "Input",ExpressionUUID->"a2552c17-3a0f-45f0-84ff-f593898cd42a"],
Cell[CellGroupData[{
Cell[66718, 1662, 611, 15, 34, "Input",ExpressionUUID->"08d97b93-0ba5-41e1-97e1-255ad9feee01"],
Cell[67332, 1679, 884, 24, 55, "Output",ExpressionUUID->"1dced842-0bea-43a4-969b-925f2139ab4a"],
Cell[68219, 1705, 884, 24, 55, "Output",ExpressionUUID->"1903115d-840b-48ee-b788-d8d1ccf569ce"]
}, Open  ]],
Cell[69118, 1732, 414, 9, 21, "Input",ExpressionUUID->"cec73689-77d4-4e48-840b-019c646edfe7"],
Cell[CellGroupData[{
Cell[69557, 1745, 618, 14, 34, "Input",ExpressionUUID->"33d58f7f-305a-4d97-95a8-b08f03b5f40b"],
Cell[70178, 1761, 1311, 30, 55, "Output",ExpressionUUID->"6eee4974-f72f-4fec-b598-5b4443b33b5a"],
Cell[71492, 1793, 1311, 30, 55, "Output",ExpressionUUID->"a0d10522-fd02-4d9b-8271-0af3ea0f9c19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72840, 1828, 274, 5, 34, "Input",ExpressionUUID->"2c5fc671-11f7-448f-8ef7-3496e27b377e"],
Cell[73117, 1835, 226, 4, 33, "Output",ExpressionUUID->"a7c04767-5fb8-4ff8-a73e-deb22ee7e708"],
Cell[73346, 1841, 228, 4, 33, "Output",ExpressionUUID->"204c01d1-49aa-4130-abc6-6aaee92a477c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73611, 1850, 511, 9, 21, "Input",ExpressionUUID->"4911431d-eb14-4e35-b45e-29fb28a8bf54"],
Cell[74125, 1861, 1117, 30, 55, "Output",ExpressionUUID->"176279f3-1136-4633-9ddf-42c6d0858f23"]
}, Open  ]],
Cell[75257, 1894, 307, 8, 34, "Input",ExpressionUUID->"c6ce5d53-fc90-4d0d-b531-aa7130f86305"],
Cell[75567, 1904, 156, 3, 21, "Input",ExpressionUUID->"545ed305-fa06-4a0d-801d-b53a5ada9a11"],
Cell[CellGroupData[{
Cell[75748, 1911, 274, 5, 34, "Input",ExpressionUUID->"d21b7677-472a-4c84-8ed5-8c57a3158de3"],
Cell[76025, 1918, 228, 4, 33, "Output",ExpressionUUID->"40ea9714-330c-4285-8e2b-d26154fb9783"],
Cell[76256, 1924, 228, 4, 33, "Output",ExpressionUUID->"b5a7e7f8-3a2e-4efa-b128-d4352b4b8290"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76521, 1933, 1425, 44, 42, "Input",ExpressionUUID->"d39275c1-484c-4c90-bdca-7ac7ffcaf670"],
Cell[77949, 1979, 756, 23, 45, "Output",ExpressionUUID->"006fa944-a556-46fa-a32e-71da8c9f1acd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78742, 2007, 1157, 35, 42, "Input",ExpressionUUID->"1fef2f0a-2b2c-4438-ab25-625b9872f68d"],
Cell[79902, 2044, 5915, 158, 108, "Output",ExpressionUUID->"20976f6d-6b9f-403e-8fb9-9c567d705e95"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85854, 2207, 935, 27, 39, "Input",ExpressionUUID->"de0998bb-0110-4aaa-b6d2-6904f0aecb65"],
Cell[86792, 2236, 278, 7, 34, "Output",ExpressionUUID->"267de128-c02d-4051-b58e-64f52bbc649d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87107, 2248, 2109, 63, 42, "Input",ExpressionUUID->"2804e1a4-bf9c-408c-98b2-c8e7f9ea7ee8"],
Cell[89219, 2313, 512, 15, 46, "Output",ExpressionUUID->"f717b6ff-66ee-4b34-84ae-a36c7f5cf949"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89768, 2333, 835, 24, 39, "Input",ExpressionUUID->"0323118f-a0f9-4030-a9c6-ded35278d104"],
Cell[90606, 2359, 308, 8, 24, "Output",ExpressionUUID->"628783a8-c425-4bc8-98ef-021f48295dd8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90951, 2372, 2073, 62, 42, "Input",ExpressionUUID->"2b00c567-473e-4751-85b3-cd419ab5c2b4"],
Cell[93027, 2436, 391, 11, 36, "Output",ExpressionUUID->"ff9ba4fe-32f6-4c30-aa99-0a6ee689213e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93455, 2452, 1193, 36, 42, "Input",ExpressionUUID->"2641c153-b436-490f-aa3a-d408ffb59c8d"],
Cell[94651, 2490, 5206, 141, 108, "Output",ExpressionUUID->"4ff076fc-c7fd-4e6f-bb15-92d15ab86eb8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99894, 2636, 868, 25, 39, "Input",ExpressionUUID->"ec763910-ca95-4360-9ffb-d22670b60c4f"],
Cell[100765, 2663, 281, 7, 34, "Output",ExpressionUUID->"e5df8c39-af54-4625-b5c8-073478f6f841"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101083, 2675, 1918, 57, 42, "Input",ExpressionUUID->"5b72e12e-9226-4032-a6a7-2e78a8345ecd"],
Cell[103004, 2734, 483, 14, 46, "Output",ExpressionUUID->"1741ec54-ad7e-450a-9db1-2b1cf8eedba7"]
}, Open  ]]
}
]
*)

